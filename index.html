<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ø¯Ø±Ø¨Ù†Ø¯ÛŒ Ù‚ÙˆØ·ÛŒ ÙÙ„Ø²ÛŒ - Ø¨Ø§ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ Ùˆ Ø¬Ø³ØªØ¬ÙˆÛŒ Ø²Ù†Ø¯Ù‡</title>
  <style>
    body { font-family: Tahoma, sans-serif; background:#eef2f7; direction:rtl; margin:0; padding:6px; color:#333; }
    header { background:#0077b6; color:#fff; padding:8px; border-radius:6px; text-align:center; margin-bottom:10px; }
    .info-text{ font-size:12px; text-align:center; margin-bottom:10px; }
    .input-row{ display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-bottom:8px; }
    .input-row label{ font-size:12px; display:flex; flex-direction:column; width:140px; background:#fff; padding:10px; border:1px solid #ccc; border-radius:6px; }
    .input-row input,.input-row select{ margin-top:6px; padding:6px 8px; font-size:14px; border:1px solid #bbb; border-radius:4px; }
    .input-row button{ align-self:flex-end; background:#0077b6; border:none; color:#fff; padding:10px 20px; border-radius:6px; cursor:pointer; font-size:14px; margin-top:24px; width:140px; }
    .input-row button:hover{ background:#005f99; }
    .row-2selects{ display:flex; justify-content:center; gap:20px; margin-bottom:12px; flex-wrap:wrap; }
    .progress-bar-container{ width:90%; max-width:500px; margin:10px auto; background:#eee; border-radius:8px; overflow:hidden; height:18px; }
    .progress-bar{ height:100%; width:0%; background:linear-gradient(90deg,#0077b6,#00c4cc); transition:width .3s; }
    table{ width:100%; border-collapse:collapse; background:#fff; margin-top:10px; }
    th,td{ border:1px solid #555; padding:10px; text-align:center; font-size:14px; font-family:Tahoma, sans-serif; vertical-align:middle; }
    th{ background:#f0f4f8; }
    #warnings{ margin:10px 16px; font-family:Tahoma, sans-serif; }
    #warnings strong{ display:block; margin-bottom:4px; }
    #warnings .warningItem{
      background:#ffe6e6; padding:6px 10px; margin:4px 0; border-radius:6px;
      font-size:14px; line-height:1.3; text-align:justify; border:1px solid #ffb3b3;
    }
    #warnings .infoItem{
      background:#e6f4ff; padding:6px 10px; margin:4px 0; border-radius:6px;
      font-size:14px; line-height:1.3; text-align:justify; border:1px solid #b3daff;
    }
    #correctionMessage{ margin-top:10px; border-top:1px solid #999; padding-top:6px; font-size:14px; color:#0077b6; font-family:Tahoma, sans-serif; word-break:break-word; }
    /* Help overlay */
    #helpOverlay{ position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,.6); display:none; align-items:center; justify-content:center; z-index:1000; }
    #helpBox{ background:#fff; max-width:600px; width:90%; padding:20px; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,.3); text-align:right; line-height:1.6; position:relative; font-size:14px; color:#333; }
    #helpCloseBtn{ position:absolute; top:8px; left:8px; padding:6px 12px; cursor:pointer; background:#3498db; color:#fff; border:none; border-radius:6px; font-size:13px; }

    /* Troubleshooting overlay (multi-page + search) */
    #tsOverlay{ position:fixed; inset:0; background:rgba(0,0,0,.7); display:none; align-items:center; justify-content:center; z-index:1100; }
    #tsBox{ background:#ffffff; width:min(820px,92vw); max-height:88vh; overflow:hidden; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.35); display:flex; flex-direction:column; }
    #tsHeader{ padding:10px 12px; background:#0d6efd; color:#fff; display:flex; gap:8px; align-items:center; justify-content:space-between; flex-wrap:wrap; }
    #tsHeader h3{ margin:0; font-size:16px; }
    .tsSearchWrap{ display:flex; align-items:center; gap:6px; background:rgba(255,255,255,.15); padding:6px; border-radius:8px; }
    #tsSearch{ border:none; outline:none; padding:6px 10px; border-radius:6px; width:220px; }
    #tsClear{ border:none; background:#fff; color:#0d6efd; padding:6px 10px; border-radius:6px; cursor:pointer; }
    #tsClose{ background:#fff; color:#0d6efd; border:none; padding:6px 10px; border-radius:6px; cursor:pointer; font-weight:bold; }
    #tsContent{ padding:14px 18px; overflow:auto; line-height:1.9; color:#2c3e50; }
    #tsFooter{ padding:10px 14px; background:#f6f8fa; display:flex; align-items:center; justify-content:space-between; gap:8px; flex-wrap:wrap; }
    .tsBtn{ border:none; padding:8px 14px; border-radius:8px; cursor:pointer; background:#0d6efd; color:#fff; font-size:14px; }
    .tsBtn:disabled{ opacity:.5; cursor:not-allowed; }
    #tsPageIndicator{ font-size:13px; color:#555; }
    .tsList{ margin:0; padding-inline-start:18px; }
    .tsList li{ margin-bottom:8px; text-align:justify; }
    .hl{ background: #fff59d; padding:0 2px; border-radius:3px; }

    .footer-buttons{ position:fixed; bottom:10px; left:10px; display:flex; flex-direction:column; gap:8px; z-index:500; }
    .footer-buttons button{ background:#0077b6; border:none; color:#fff; padding:8px 12px; border-radius:6px; cursor:pointer; font-size:14px; width:180px; text-align:center; }
    .footer-buttons button:hover{ background:#005f99; }
    #pageFooter{ position:fixed; bottom:0; width:100%; background:#f1f1f1; text-align:center; padding:8px 0; font-size:14px; border-top:1px solid #ccc; font-family:Tahoma, sans-serif; }

    @media print{
      body *{ visibility:hidden; }
      #printArea, #printArea *, #warnings, #warnings *, #correctionMessage, #pageFooter, #printHeader, #printFooter{ visibility:visible !important; }
      #printArea{ position:absolute !important; top:0; left:0; width:100%; }
      .footer-buttons{ display:none !important; }
    }
    #printHeader{ display:flex; justify-content:space-between; margin-bottom:10px; font-size:14px; font-weight:bold; border-bottom:1px solid #999; padding-bottom:8px; visibility:hidden; }
    #printHeader div{ width:33%; text-align:center; }
    #printFooter{ text-align:center; font-size:12px; color:#666; margin-top:20px; border-top:1px solid #ccc; padding-top:8px; visibility:hidden; }
  </style>
</head>
<body>

<header>
  <h2>Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ù‚ÙˆØ·ÛŒ ÙÙ„Ø²ÛŒ v1.16</h2>
  <p>ØªÙ‡ÛŒÙ‡â€ŒÚ©Ù†Ù†Ø¯Ù‡: Ù…ØµÛŒØ¨ Ø®Ø§Ù†ÛŒ - Ú©Ø§Ø±Ø´Ù†Ø§Ø³ Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒØª Ú©Ø§Ø±Ø®Ø§Ù†Ù‡ ÛŒÚ© ÙˆÛŒÚ© Ø¯Ø´Øª Ù…Ø±ØºØ§Ø¨</p>
</header>

<p class="info-text" id="infoText">ğŸ”¹ ØªÙ…Ø§Ù… Ù…Ù‚Ø§Ø¯ÛŒØ± Ø¨Ø± Ø­Ø³Ø¨ <strong>0.001 Ø§ÛŒÙ†Ú†</strong> Ù‡Ø³ØªÙ†Ø¯ ğŸ”¹</p>

<div class="row-2selects">
  <label>ğŸ“¦ Ù†ÙˆØ¹ Ø¸Ø±Ù:
    <select id="containerType">
      <option>Ø§Ù†ØªØ®Ø§Ø¨</option><option>Ù‚ÙˆØ·ÛŒ 400 Ú¯Ø±Ù…ÛŒ Ú†Ø§Ù¾Ø¯Ø§Ø±</option><option>Ù‚ÙˆØ·ÛŒ 420 Ú¯Ø±Ù…ÛŒ Ú†Ø§Ù¾Ø¯Ø§Ø±</option>
      <option>Ù‚ÙˆØ·ÛŒ 770 Ú¯Ø±Ù…ÛŒ Ú†Ø§Ù¾Ø¯Ø§Ø±</option><option>Ù‚ÙˆØ·ÛŒ 800 Ú¯Ø±Ù…ÛŒ Ú†Ø§Ù¾Ø¯Ø§Ø±</option><option>Ù‚ÙˆØ·ÛŒ 4000 Ú¯Ø±Ù…ÛŒ Ú†Ø§Ù¾Ø¯Ø§Ø±</option>
      <option>Ø­Ù„Ø¨ 16 Ú©ÛŒÙ„ÙˆÛŒÛŒ Ú†Ø§Ù¾Ø¯Ø§Ø±</option><option>Ø­Ù„Ø¨ 17 Ú©ÛŒÙ„ÙˆÛŒÛŒ Ú†Ø§Ù¾Ø¯Ø§Ø±</option><option>Ù‚ÙˆØ·ÛŒ 400 Ú¯Ø±Ù…ÛŒ Ø³Ø§Ø¯Ù‡</option><option>Ù‚ÙˆØ·ÛŒ 420 Ú¯Ø±Ù…ÛŒ Ø³Ø§Ø¯Ù‡</option>
      <option>Ù‚ÙˆØ·ÛŒ 770 Ú¯Ø±Ù…ÛŒ Ø³Ø§Ø¯Ù‡</option><option>Ù‚ÙˆØ·ÛŒ 800 Ú¯Ø±Ù…ÛŒ Ø³Ø§Ø¯Ù‡</option><option>Ù‚ÙˆØ·ÛŒ 4000 Ú¯Ø±Ù…ÛŒ Ø³Ø§Ø¯Ù‡</option><option>Ø­Ù„Ø¨ 16 Ú©ÛŒÙ„ÙˆÛŒÛŒ Ø³Ø§Ø¯Ù‡</option>
      <option>Ø­Ù„Ø¨ 17 Ú©ÛŒÙ„ÙˆÛŒÛŒ Ø³Ø§Ø¯Ù‡</option>
    </select>
  </label>
  <label>ğŸ“ ÙˆØ§Ø­Ø¯ ÙˆØ±ÙˆØ¯ÛŒ:
    <select id="unitSelect">
      <option value="thou">0.001 Ø§ÛŒÙ†Ú†</option>
      <option value="mm">Ù…ÛŒÙ„ÛŒÙ…ØªØ±</option>
    </select>
  </label>
</div>

<div class="input-row">
  <label> Ø·ÙˆÙ„ Ø¯ÙˆØ®Øª-SL<input type="number" id="length" min="0" step="0.01" autocomplete="off"></label>
  <label>Ø¯ÙˆØ®Øª Ø¶Ø®Ø§Ù…Øª-ST<input type="number" id="seamThickness" min="0" step="0.01" autocomplete="off"></label>
  <label>Ù‚Ù„Ø§Ø¨ Ø¯Ø±Ø¨-CH<input type="number" id="coverHook" min="0" step="0.01" autocomplete="off"></label>
  <label>Ù‚Ù„Ø§Ø¨ Ø¨Ø¯Ù†Ù‡-BH<input type="number" id="bodyHook" min="0" step="0.01" autocomplete="off"></label>
  <label>Ø¶Ø®Ø§Ù…Øª ÙˆØ±Ù‚ Ø³Ø±-Te<input type="number" id="headThickness" min="0" step="0.01" autocomplete="off"></label>
  <label>Ø¶Ø®Ø§Ù…Øª ÙˆØ±Ù‚ Ø¨Ø¯Ù†Ù‡-Tb<input type="number" id="bodyThickness" min="0" step="0.01" autocomplete="off"></label>
  <button id="calcBtn" onclick="addTemplate()">â• Ù…Ø­Ø§Ø³Ø¨Ù‡/Ø¬Ø¯ÛŒØ¯</button>
</div>

<div class="progress-bar-container"><div class="progress-bar" id="progress"></div></div>

<div id="printArea">
  <div id="printHeader">
    <div>ğŸ“… ØªØ§Ø±ÛŒØ®: <span id="analysisDate"></span></div>
    <div>ğŸ“¦ Ø¸Ø±Ù: <span id="containerSelected"></span></div>
    <div>ğŸ‘¤ Ú¯Ø²Ø§Ø±Ø´Ú¯Ø±: <span id="reporterName"></span></div>
  </div>

  <table id="resultsTable" dir="rtl">
    <thead>
      <tr id="headerRow"><th>ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§</th></tr>
    </thead>
    <tbody id="tableBody">
      <tr><td>Ø¯ÙˆØ®Øª Ø·ÙˆÙ„ (SL)</td></tr>
      <tr><td>Ø¯ÙˆØ®Øª Ø¶Ø®Ø§Ù…Øª (ST)</td></tr>
      <tr><td>Ù‚Ù„Ø§Ø¨ Ø¯Ø±Ø¨ (CH)</td></tr>
      <tr><td>Ù‚Ù„Ø§Ø¨ Ø¨Ø¯Ù†Ù‡ (BH)</td></tr>
      <tr><td>Ø¶Ø®Ø§Ù…Øª Ø³Ø± (Te)</td></tr>
      <tr><td>Ø¶Ø®Ø§Ù…Øª Ø¨Ø¯Ù†Ù‡ (Tb)</td></tr>
      <tr><td>Ù‚Ù„Ø§Ø¨ Ø§Ø®ØªÙ„Ø§Ù (Î”H)</td></tr>
      <tr><td>ÙØ¶Ø§ÛŒ Ø¢Ø²Ø§Ø¯ (FS)</td></tr>
      <tr><td>Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ (OL%)</td></tr>
      <tr><td>Ú†Ø±ÙˆÚ©ÛŒØ¯Ú¯ÛŒ (Wr)</td></tr>
      <tr><td>ØªÛŒØ²Ú©Ø±Ø¯Ú¯ÛŒ (Sh)</td></tr>
    </tbody>
  </table>
</div>

<div id="warnings">
  <strong>âš ï¸ Ù…ÙˆØ§Ø±Ø¯ Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ Ø§ØµÙ„Ø§Ø­ Ùˆ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§:</strong>
  <div id="warningList"></div>
  <div id="correctionMessage"></div>
</div>

<div class="footer-buttons">
  <button onclick="printReport()">ğŸ–¨ï¸ Ù¾Ø±ÛŒÙ†Øª</button>
  <button onclick="exportToExcel()">ğŸ“¤ Excel</button>
  <button onclick="saveAsHTML()">ğŸ’¾ HTML</button>
  <button onclick="showHelp()">â„¹ï¸ Ø±Ø§Ù‡Ù†Ù…Ø§</button>
  <button onclick="openTroubleshooting()">ğŸ“š Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ</button>
</div>

<!-- Help Overlay -->
<div id="helpOverlay">
  <div id="helpBox"></div>
</div>

<!-- Troubleshooting Overlay (multi-page + live search) -->
<div id="tsOverlay" aria-hidden="true">
  <div id="tsBox">
    <div id="tsHeader">
      <h3>Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¹ÛŒØ¨â€ŒÛŒØ§Ø¨ÛŒ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ø¯Ø±Ø¨Ù†Ø¯ÛŒ</h3>
      <div class="tsSearchWrap">
        <input id="tsSearch" type="text" placeholder="Ø¬Ø³ØªØ¬ÙˆÛŒ Ø²Ù†Ø¯Ù‡..." />
        <button id="tsClear" title="Ù¾Ø§Ú©â€ŒÚ©Ø±Ø¯Ù† Ø¬Ø³ØªØ¬Ùˆ">Ù¾Ø§Ú©</button>
      </div>
      <button id="tsClose">Ø¨Ø³ØªÙ†</button>
    </div>
    <div id="tsContent"></div>
    <div id="tsFooter">
      <button class="tsBtn" id="tsPrev">Ù‚Ø¨Ù„ÛŒ</button>
      <span id="tsPageIndicator">ØµÙØ­Ù‡ 1 Ø§Ø² N</span>
      <button class="tsBtn" id="tsNext">Ø¨Ø¹Ø¯ÛŒ</button>
    </div>
  </div>
</div>

<div id="pageFooter">
  Â© Û²Û°Û²Ûµ Ú©Ø§Ø±Ø®Ø§Ù†Ù‡ ÛŒÚ©â€ŒÙˆâ€ŒÛŒÚ© | Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡: Ù…ØµÛŒØ¨ Ø®Ø§Ù†ÛŒ
</div>

<script>
/* ---------- Ù…Ù†Ø·Ù‚ Ø§ØµÙ„ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ (Ø¨Ø¯ÙˆÙ† ØªØºÛŒÛŒØ± Ù†Ø³Ø¨Øª Ø¨Ù‡ Ù†Ø³Ø®Ù‡ Ù‚Ø¨Ù„ÛŒ) ---------- */
let templatesData = [];
let isEditing = false;
let editingIndex = -1;
let correctionHistory = []; // [{title, count}]
const inputsOrder = ['length','seamThickness','coverHook','bodyHook','headThickness','bodyThickness'];

function toMM(thou){ return thou * 0.0254; }
function toThou(mm){ return mm / 0.0254; }
function formatVal(thou, unit){ return unit==='mm' ? (toMM(thou).toFixed(2)+' (mm)') : (thou.toFixed(2)+' (thou)'); }

function updateProgress(){
  const ins = inputsOrder.map(id => document.getElementById(id));
  const filled = ins.filter(i => i.value !== '').length;
  document.getElementById('progress').style.width = (filled / ins.length * 100) + '%';
}
document.querySelectorAll('.input-row input,.input-row select').forEach(i => {
  i.addEventListener('input', e => {
    if(e.target.id === 'unitSelect'){
      const unit = e.target.value;
      document.getElementById('infoText').innerHTML =
        unit === 'thou'
          ? 'ğŸ”¹ ØªÙ…Ø§Ù… Ù…Ù‚Ø§Ø¯ÛŒØ± Ø¨Ø± Ø­Ø³Ø¨ <strong>0.001 Ø§ÛŒÙ†Ú†</strong> Ù‡Ø³ØªÙ†Ø¯ ğŸ”¹'
          : 'ğŸ”¹ ØªÙ…Ø§Ù… Ù…Ù‚Ø§Ø¯ÛŒØ± Ø¨Ø± Ø­Ø³Ø¨ <strong>Ù…ÛŒÙ„ÛŒÙ…ØªØ±</strong> Ù‡Ø³ØªÙ†Ø¯ ğŸ”¹';
    }
    updateProgress();
  });
});
inputsOrder.forEach((id, i) => {
  const el = document.getElementById(id);
  el.addEventListener('keydown', e => {
    if(e.key === 'Enter'){
      e.preventDefault();
      if(i < inputsOrder.length - 1){
        document.getElementById(inputsOrder[i + 1]).focus();
      } else {
        document.getElementById('calcBtn').focus();
      }
    }
  });
});
document.getElementById('calcBtn').addEventListener('keydown', e => { if(e.key==='Enter'){ e.preventDefault(); addTemplate(); } });

const LIMITS_T = { CH_MIN:70, BH_MIN:70, DIFF_MAX:7.8, FREE_MAX:7.5, OL_MIN:45 };

function addTemplate(){
  const unit = document.getElementById('unitSelect').value;
  let raw = inputsOrder.map(id => parseFloat(document.getElementById(id).value));
  if(raw.some(v => isNaN(v) || v < 0)){ alert('Ù„Ø·ÙØ§Ù‹ Ù‡Ù…Ù‡ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø±Ø§ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯'); return; }
  if(unit === 'mm') raw = raw.map(v => toThou(v));
  const [L, ST, CH, BH, Te, Tb] = raw;

  const diff = Math.abs(CH - BH);
  const free = Math.abs(ST - (3*Te + 2*Tb));
  const denom = L - (2.2*Te + 1.1*Tb);
  const overlap = denom ? Math.abs((L - (CH + BH + 1.1*Te)) / denom * 100) : 0;

  const newIndex = templatesData.length;
  templatesData.push({L,ST,CH,BH,Te,Tb});

  const title = isEditing ? `Ø§ØµÙ„Ø§Ø­ÛŒÙ‡ Ù‚Ø§Ù„Ø¨ ${editingIndex + 1}` : `Ù‚Ø§Ù„Ø¨ ${countOriginals() + 1}`;

  const th = document.createElement('th');
  th.innerHTML = `${title}<br>
    <input type="checkbox" class="editCheck" data-idx="${newIndex}">
    <button class="del" style="margin-left:6px">Ø­Ø°Ù</button>`;
  document.getElementById('headerRow').appendChild(th);

  th.querySelector('.del').onclick = () => {
    const colIndex = [...document.getElementById('headerRow').children].indexOf(th);
    th.remove();
    document.querySelectorAll('#tableBody tr').forEach(r => { if(r.children[colIndex]) r.children[colIndex].remove(); });
    removeWarningByTitle(title);
    correctionHistory = correctionHistory.filter(obj => obj.title !== title);
    renderCorr();
    isEditing = false; editingIndex = -1; document.getElementById('calcBtn').textContent = 'â• Ù…Ø­Ø§Ø³Ø¨Ù‡/Ø¬Ø¯ÛŒØ¯';
  };

  const colIndex = document.getElementById('headerRow').children.length - 1;
  const vals = [L, ST, CH, BH, Te, Tb, diff, free, overlap, '-', '-'];
  addValuesToTable(colIndex, vals, unit);

  const warns = [];
  const mark = (row, msg) => {
    document.querySelectorAll('#tableBody tr')[row].children[colIndex].style.background = '#ffd2d2';
    warns.push(msg);
  };
  if (CH < LIMITS_T.CH_MIN) mark(2, `Ù‚Ù„Ø§Ø¨ Ø¯Ø±Ø¨ Ú©Ù…ØªØ± Ø§Ø² ${formatVal(LIMITS_T.CH_MIN, unit)}`);
  if (BH < LIMITS_T.BH_MIN) mark(3, `Ù‚Ù„Ø§Ø¨ Ø¨Ø¯Ù†Ù‡ Ú©Ù…ØªØ± Ø§Ø² ${formatVal(LIMITS_T.BH_MIN, unit)}`);
  if (diff > LIMITS_T.DIFF_MAX) mark(6, `Ø§Ø®ØªÙ„Ø§Ù Ù‚Ù„Ø§Ø¨ Ø¨ÛŒØ´ØªØ± Ø§Ø² ${formatVal(LIMITS_T.DIFF_MAX, unit)}`);
  if (free > LIMITS_T.FREE_MAX) mark(7, `ÙØ¶Ø§ÛŒ Ø¢Ø²Ø§Ø¯ Ø¨ÛŒØ´ØªØ± Ø§Ø² ${formatVal(LIMITS_T.FREE_MAX, unit)}`);
  if (overlap < LIMITS_T.OL_MIN) mark(8, `Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ú©Ù…ØªØ± Ø§Ø² ${LIMITS_T.OL_MIN}%`);

  clearWarningList(title);
  clearInfoByTitle(title);

  if(warns.length > 0){ addWarning(`${title}: ${warns.join(' Ø› ')}`); }
  if (isEditing) { const baseTemplate = `Ù‚Ø§Ù„Ø¨ ${editingIndex + 1}`; addInfo(`${title}: Ø¬Ù‡Øª Ø§ØµÙ„Ø§Ø­ ${baseTemplate} Ø«Ø¨Øª Ø´Ø¯`); }

  correctionHistory.push({ title, count: warns.length });
  renderCorr();

  inputsOrder.forEach(id => document.getElementById(id).value = '');
  isEditing = false; editingIndex = -1;
  document.getElementById('calcBtn').textContent = 'â• Ù…Ø­Ø§Ø³Ø¨Ù‡/Ø¬Ø¯ÛŒØ¯';
  updateProgress();
}

function countOriginals(){
  const ths = [...document.getElementById('headerRow').children];
  let count = 0;
  for(let i=1;i<ths.length;i++){
    const title = ths[i].textContent.trim().split('\n')[0];
    if(/^Ù‚Ø§Ù„Ø¨\s+\d+$/u.test(title)) count++;
  }
  return count;
}

function addValuesToTable(col, vals, unit){
  const rows = document.querySelectorAll('#tableBody tr');
  for(let i=0; i<vals.length; i++){
    let cell = rows[i].children[col];
    if(!cell){ cell = document.createElement('td'); rows[i].appendChild(cell); }
    const v = vals[i];
    if(typeof v === 'number'){
      if(i >= 9){ cell.textContent = v; }
      else if(i === 8){ cell.textContent = v.toFixed(1) + ' (%)'; }
      else { cell.textContent = formatVal(v, unit); }
    } else { cell.textContent = v; }
    cell.style.background = '';
  }
}

/* Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ */
function addWarning(text){ const div=document.createElement('div'); div.className='warningItem'; div.textContent=text; document.getElementById('warningList').appendChild(div); }
function addInfo(text){ const div=document.createElement('div'); div.className='infoItem'; div.textContent=text; document.getElementById('warningList').appendChild(div); }
function clearWarningList(templateTitle){
  const list=document.getElementById('warningList');
  [...list.children].forEach(child => { if(child.classList.contains('warningItem') && child.textContent.startsWith(templateTitle)) child.remove(); });
}
function clearInfoByTitle(templateTitle){
  const list=document.getElementById('warningList');
  [...list.children].forEach(child => { if(child.classList.contains('infoItem') && child.textContent.startsWith(templateTitle)) child.remove(); });
}
function removeWarningByTitle(templateTitle){
  const list=document.getElementById('warningList');
  [...list.children].forEach(child => { if(child.textContent.startsWith(templateTitle)) child.remove(); });
}
function renderCorr(){ const total=document.querySelectorAll('#warningList .warningItem').length; document.getElementById('correctionMessage').textContent = total>0 ? `Ø¬Ù…Ø¹ Ú©Ù„ Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§: ${total} Ù…ÙˆØ±Ø¯` : ''; }

/* ÙˆÛŒØ±Ø§ÛŒØ´: Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…Ù‚Ø§Ø¯ÛŒØ± */
document.addEventListener('change', e => {
  if(e.target.classList.contains('editCheck')){
    if(e.target.checked){
      isEditing = true; editingIndex = +e.target.dataset.idx; loadTemplate(editingIndex);
      document.querySelectorAll('.editCheck').forEach(chk => { if(chk !== e.target) chk.checked = false; });
      document.getElementById('calcBtn').textContent = 'ğŸ“ Ø§ØµÙ„Ø§Ø­ Ù‚Ø§Ù„Ø¨'; document.getElementById('calcBtn').focus();
    } else { isEditing=false; editingIndex=-1; clearInputs(); document.getElementById('calcBtn').textContent='â• Ù…Ø­Ø§Ø³Ø¨Ù‡/Ø¬Ø¯ÛŒØ¯'; }
  }
});
function loadTemplate(idx){
  const t = templatesData[idx]; if(!t) return;
  const unit = document.getElementById('unitSelect').value;
  document.getElementById('length').value        = unit==='mm'? toMM(t.L).toFixed(2)  : t.L.toFixed(2);
  document.getElementById('seamThickness').value = unit==='mm'? toMM(t.ST).toFixed(2) : t.ST.toFixed(2);
  document.getElementById('coverHook').value     = unit==='mm'? toMM(t.CH).toFixed(2) : t.CH.toFixed(2);
  document.getElementById('bodyHook').value      = unit==='mm'? toMM(t.BH).toFixed(2) : t.BH.toFixed(2);
  document.getElementById('headThickness').value = unit==='mm'? toMM(t.Te).toFixed(2) : t.Te.toFixed(2);
  document.getElementById('bodyThickness').value = unit==='mm'? toMM(t.Tb).toFixed(2) : t.Tb.toFixed(2);
}
function clearInputs(){ inputsOrder.forEach(id => document.getElementById(id).value = ''); }

/* Ù¾Ø±ÛŒÙ†Øª/Ø§Ú©Ø³Ù„/HTML */
function printReport(){
  const name = "Ù…Ù‡Ù†Ø¯Ø³ Ø®Ø§Ù†ÛŒ";
  document.getElementById('reporterName').textContent = name;
  document.getElementById('containerSelected').textContent = document.getElementById('containerType').value || '-';
  document.getElementById('analysisDate').textContent = new Date().toLocaleDateString('fa-IR');
  const hdr=document.getElementById('printHeader'); const prevVis=hdr.style.visibility; hdr.style.visibility='visible'; window.print(); hdr.style.visibility=prevVis||'hidden';
}
function exportToExcel(){
  const table=document.getElementById('resultsTable').outerHTML;
  const warningsHTML=document.getElementById('warningList').outerHTML;
  const corrHTML=document.getElementById('correctionMessage').outerHTML;
  const style = `
    <style>
      table, th, td{ border:1px solid #555; border-collapse:collapse; padding:6px; text-align:center; font-family:Tahoma, sans-serif; font-size:12pt; }
      th{ background-color:#f0f4f8; }
      .warningItem{ background:#ffe6e6; border:1px solid #ffb3b3; padding:4px 6px; margin:2px 0; }
      .infoItem{ background:#e6f4ff; border:1px solid #b3daff; padding:4px 6px; margin:2px 0; }
    </style>`;
  const html = `<!DOCTYPE html><html lang="fa" dir="rtl"><head><meta charset="UTF-8">${style}</head><body>
    ${table}<h3>Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§</h3>${warningsHTML}${corrHTML}
  </body></html>`;
  const blob=new Blob([html], {type:'application/vnd.ms-excel'}); const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='ØªØ­Ù„ÛŒÙ„_Ø¯Ø±Ú¯ÛŒØ±ÛŒ.xls'; a.click(); URL.revokeObjectURL(url);
  setTimeout(()=>alert('Ù¾Ø³ Ø§Ø² Ø°Ø®ÛŒØ±Ù‡ ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ØŒ Ø±ÙˆÛŒ ÙØ§ÛŒÙ„ Ø±Ø§Ø³Øªâ€ŒÚ©Ù„ÛŒÚ© Ú©Ø±Ø¯Ù‡ Ùˆ Ú¯Ø²ÛŒÙ†Ù‡ "Unblock" Ø±Ø§ ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯.'), 200);
}
function saveAsHTML(){
  const name = prompt('Ù†Ø§Ù… Ú¯Ø²Ø§Ø±Ø´Ú¯Ø±', 'Ù…Ù‡Ù†Ø¯Ø³ Ø®Ø§Ù†ÛŒ') || 'Ù…Ù‡Ù†Ø¯Ø³ Ø®Ø§Ù†ÛŒ';
  const date = new Date().toLocaleDateString('fa-IR');
  const hdr=document.getElementById('printHeader'); const prevVis=hdr.style.visibility;
  hdr.style.visibility='visible';
  document.getElementById('analysisDate').textContent=date;
  document.getElementById('reporterName').textContent=name;
  document.getElementById('containerSelected').textContent=document.getElementById('containerType').value || '-';
  const content=`
  <!DOCTYPE html><html lang="fa" dir="rtl"><head><meta charset="UTF-8" />
  <title>Ú¯Ø²Ø§Ø±Ø´ ØªØ­Ù„ÛŒÙ„ Ø¯Ø±Ú¯ÛŒØ±ÛŒ</title>
  <style>
    body{ font-family:Tahoma, sans-serif; direction:rtl; background:#fff; color:#333; margin:20px; }
    table{ width:100%; border-collapse:collapse; margin-bottom:15px; }
    th,td{ border:1px solid #555; padding:6px; text-align:center; font-size:14px; }
    th{ background-color:#f0f4f8; }
    .warningItem{ background:#ffe6e6; border:1px solid #ffb3b3; padding:6px 10px; margin:4px 0; border-radius:6px; }
    .infoItem{ background:#e6f4ff; border:1px solid #b3daff; padding:6px 10px; margin:4px 0; border-radius:6px; }
    #pageFooter{ font-size:12px; color:#666; text-align:center; border-top:1px solid #ccc; padding-top:8px; margin-top:12px; }
  </style></head><body>
    ${document.getElementById('printArea').innerHTML}
    <h3>Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§</h3>
    <div>${document.getElementById('warningList').innerHTML}</div>
    <div id="correctionMessage">${document.getElementById('correctionMessage').innerHTML}</div>
    <div id="pageFooter">Â© Û²Û°Û²Ûµ Ú©Ø§Ø±Ø®Ø§Ù†Ù‡ ÛŒÚ©â€ŒÙˆâ€ŒÛŒÚ© | Ù†ÙˆÛŒØ³Ù†Ø¯Ù‡: Ù…ØµÛŒØ¨ Ø®Ø§Ù†ÛŒ</div>
  </body></html>`;
  const blob=new Blob([content], {type:'text/html'}); const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download=`Ú¯Ø²Ø§Ø±Ø´_${date}.html`; a.click(); URL.revokeObjectURL(url);
  hdr.style.visibility=prevVis||'hidden';
}

/* Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø³Ø±ÛŒØ¹ */
function showHelp(){
  const helpHTML = `
<div style="font-family:Tahoma; direction:rtl; line-height:1.6; background:#f9f9f9; border-radius:10px; padding:15px; border:1px solid #ccc; max-width:600px; margin:auto;">
  <h2 style="color:#2c3e50; text-align:center;">ğŸ“˜ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø³Ø±ÛŒØ¹ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ</h2>
  <p style="text-align:center; color:#555; font-size:14px;">
    Ø§ÛŒÙ† Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ (Overlap) Ùˆ Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø§Ø±Ø§Ù…ØªØ±Ù‡Ø§ÛŒ Ø¯Ø±Ø¨Ù†Ø¯ÛŒ Ù‚ÙˆØ·ÛŒ ÙÙ„Ø²ÛŒ Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª.
  </p>

  <ol style="padding-right:20px; color:#333; font-size:14px;">
    <li><b>Ø§Ù†ØªØ®Ø§Ø¨ Ø¸Ø±Ù Ùˆ ÙˆØ§Ø­Ø¯:</b> Ù†ÙˆØ¹ Ù‚ÙˆØ·ÛŒ Ùˆ ÙˆØ§Ø­Ø¯ Ø§Ù†Ø¯Ø§Ø²Ù‡â€ŒÚ¯ÛŒØ±ÛŒ (Ù…ÛŒÙ„ÛŒÙ…ØªØ± ÛŒØ§ 0.001") Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.</li>
    <li><b>ÙˆØ±ÙˆØ¯ Ù…Ù‚Ø§Ø¯ÛŒØ±:</b> Ø§Ø¹Ø¯Ø§Ø¯ SLØŒ STØŒ CHØŒ BHØŒ Te Ùˆ Tb Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ø±Ø¯Ù‡ Ùˆ Â«Ù…Ø­Ø§Ø³Ø¨Ù‡Â» Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.</li>
    <li><b>Ù†ØªØ§ÛŒØ¬ Ùˆ Ù‡Ø´Ø¯Ø§Ø±:</b> Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ú©Ù…ØªØ± Ø§Ø² 45Ùª Ø¨Ø§ Ø±Ù†Ú¯ Ù‚Ø±Ù…Ø² Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙˆØ§Ø­Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ø´Ù…Ø§ Ù‡Ø³ØªÙ†Ø¯.</li>
    <li><b>Ø§ØµÙ„Ø§Ø­ Ù‚Ø§Ù„Ø¨:</b> ØªÛŒÚ© Ù‚Ø§Ù„Ø¨ Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯ØŒ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø±Ø§ ØªØºÛŒÛŒØ± Ø¯Ù‡ÛŒØ¯ Ùˆ Ø±ÙˆÛŒ Â«Ø§ØµÙ„Ø§Ø­ Ù‚Ø§Ù„Ø¨Â» Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯. Ù†ØªÛŒØ¬Ù‡ Ø¨Ø§ Ù†Ø§Ù… <span style="color:#2980b9;">Â«Ø§ØµÙ„Ø§Ø­ÛŒÙ‡ Ù‚Ø§Ù„Ø¨XÂ»</span> Ø°Ø®ÛŒØ±Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</li>
    <li><b>Ø®Ø±ÙˆØ¬ÛŒ:</b> Ø¨Ø§ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ Ø®Ø±ÙˆØ¬ÛŒ <span style="color:#27ae60;">Ù¾Ø±ÛŒÙ†Øª</span>ØŒ <span style="color:#27ae60;">Ø§Ú©Ø³Ù„</span> ÛŒØ§ HTML Ø¨Ú¯ÛŒØ±ÛŒØ¯ ÛŒØ§ Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ Ø±Ø§ Ø­Ø°Ù Ú©Ù†ÛŒØ¯.</li>
    <li><b>Ù†Ú©ØªÙ‡ Ù…Ù‡Ù… ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„:</b> Ù¾Ø³ Ø§Ø² Ø°Ø®ÛŒØ±Ù‡ØŒ Ø±ÙˆÛŒ ÙØ§ÛŒÙ„ Ø±Ø§Ø³Øªâ€ŒÚ©Ù„ÛŒÚ© Ú©Ø±Ø¯Ù‡ Ùˆ Ú¯Ø²ÛŒÙ†Ù‡ <span style="color:#c0392b;">Unblock</span> Ø±Ø§ ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯ ØªØ§ Ø¨Ø¯ÙˆÙ† Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø¨Ø§Ø² Ø´ÙˆØ¯.</li>
  </ol>

  <div style="background:#eef6ff; padding:10px; border-radius:8px; margin-top:10px; font-size:13px;">
    <b>ğŸ“ Ø­Ø¯ÙˆØ¯ Ù…Ø¬Ø§Ø²:</b><br>
    CH â‰¥ 1.78mm ØŒ BH â‰¥ 1.78mm ØŒ Î”H â‰¤ 0.20mm ØŒ FS â‰¤ 0.19mm ØŒ OL% â‰¥ 45%<br>
    <span style="color:#777;">ÙˆØ§Ø­Ø¯ Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ ÙˆØ§Ø­Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ Ø´Ù…Ø§ Ø§Ø³Øª.</span>
  </div>

  <div style="background:#fff4e5; padding:10px; border-radius:8px; margin-top:10px; font-size:13px;">
    <b>ğŸ’¡ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª Ùˆ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ:</b><br>
    Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ØŒ Ø§Ù†ØªÙ‚Ø§Ø¯ ÛŒØ§ Ø³ÙˆØ§Ù„ Ø¨Ø§ Ù…Ø§ Ø¯Ø± ØªÙ…Ø§Ø³ Ø¨Ø§Ø´ÛŒØ¯:<br>
    ğŸ“§ <a href="mailto:mosayeb872@gmail.com" style="color:#d35400;">mosayeb872@gmail.com</a><br>
    ğŸ“ <span style="color:#27ae60;">0912-320-6052</span>
  </div>

  <p style="text-align:center; margin-top:10px; font-size:12px; color:#777;">
    Â© Û²Û°Û²Ûµ - Ù…ØµÛŒØ¨ Ø®Ø§Ù†ÛŒ- Ú©Ø§Ø±Ø®Ø§Ù†Ù‡ ÛŒÚ© ÙˆÛŒÚ© Ø¯Ø´Øª Ù…Ø±ØºØ§Ø¨
  </p>
    <div style="text-align:center;">
      <button id="helpCloseBtn" style="padding:8px 15px; border:none; background:#3498db; color:white; border-radius:5px; cursor:pointer;">Ø¨Ø³ØªÙ†</button></div>
  </div>`;
  const helpBox = document.getElementById('helpBox');
  helpBox.innerHTML = helpHTML;
  document.getElementById('helpOverlay').style.display = 'flex';
  document.getElementById('helpCloseBtn').onclick = () => { document.getElementById('helpOverlay').style.display = 'none'; };
}

/* ---------- Troubleshooting content (pages) ---------- */
const tsPages = [
`<p>Ù¾Ø³ Ø§Ø² ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÙˆÙ„ÛŒÙ‡ Ø¯Ø³ØªÚ¯Ø§Ù‡ Ø¯Ø±Ø¨Ù†Ø¯ÛŒ Ùˆ Ù†Ù…ÙˆÙ†Ù‡â€ŒØ¨Ø±Ø¯Ø§Ø±ÛŒ Ùˆ Ø¢Ø²Ù…Ø§ÛŒØ´Ø§Øª Ù„Ø§Ø²Ù…ØŒ Ø¯Ø± ØµÙˆØ±Øª ÙˆØ¬ÙˆØ¯ Ø§Ø´Ú©Ø§Ù„ Ùˆ Ø¨Ø§ ÙØ±Ø¶ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø¨ÙˆØ¯Ù† ØªÙ…Ø§Ù…ÛŒ Ø§Ø¨Ø¹Ø§Ø¯ ÙÙ†ÛŒ Ù‚ÙˆØ·ÛŒâ€ŒÙ‡Ø§ÛŒ Ø³Ø§Ø®ØªÙ‡â€ŒØ´Ø¯Ù‡ØŒ Ù…Ø·Ø§Ø¨Ù‚ Ù…ÙˆØ§Ø±Ø¯ Ø²ÛŒØ± Ø§Ù‚Ø¯Ø§Ù… Ú©Ù†ÛŒØ¯.</p>
<ol class="tsList" start="1">
  <li><b>Ø·ÙˆÙ„ Ù‚Ù„Ø§Ø¨ Ø³Ø± â€“ Ú©Ù… Ø¨ÙˆØ¯Ù† Ø§Ø² Ø­Ø¯ Ù…Ø¬Ø§Ø²:</b> ØªÙ†Ø¸ÛŒÙ… Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ Ø§ÙˆÙ„ (Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ± Ø¨Ù‡ Ø¯ÛŒØ³Ú© ØªØ§ Ø­Ø¯ Ù…Ø¬Ø§Ø² Ø§ÙÙ‚ÛŒ)ØŒ ØªÙ†Ø¸ÛŒÙ… Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ Ø¯ÙˆÙ… Ù†ÛŒØ² Ù…Ø¤Ø«Ø± Ø§Ø³Øª. Ú©Ù†ØªØ±Ù„ Ø§Ø¨Ø¹Ø§Ø¯ Ø¯ÛŒØ³Ú© Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø¯Ø±Ø¨ Ù‚ÙˆØ·ÛŒ. Ø¯Ø± ØµÙˆØ±Øª Ø¹Ø¯Ù… Ø§ØµÙ„Ø§Ø­ØŒ ØªØ¹ÙˆÛŒØ¶ Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ·Ù‡.</li>
  <li><b>Ø·ÙˆÙ„ Ù‚Ù„Ø§Ø¨ Ø³Ø± â€“ Ø²ÛŒØ§Ø¯ØªØ± Ø§Ø² Ø­Ø¯ Ù…Ø¬Ø§Ø²:</b> ÙØ§ØµÙ„Ù‡â€ŒØ¯Ø§Ø± Ú©Ø±Ø¯Ù† Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ Ø§ÙˆÙ„ Ø§Ø² Ø¯ÛŒØ³Ú© (ÙÛŒÙ„Ø± Ø¨Ø²Ø±Ú¯â€ŒØªØ±). Ø¯Ø± ØµÙˆØ±Øª Ø¹Ø¯Ù… Ø§ØµÙ„Ø§Ø­ØŒ Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ Ø¯ÙˆÙ… Ù†ÛŒØ² Ø¨Ø§ ÙÛŒÙ„Ø± Ø¨Ø²Ø±Ú¯â€ŒØªØ± ØªÙ†Ø¸ÛŒÙ… Ú¯Ø±Ø¯Ù†Ø¯ (Ø¨Ø§ Ø­ÙØ¸ Ø¶Ø®Ø§Ù…Øª Ø¯ÙˆØ®Øª Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯). Ø¯Ø± Ù†Ù‡Ø§ÛŒØª ØªØ¹ÙˆÛŒØ¶ Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§.</li>
</ol>`,
`<ol class="tsList" start="3">
  <li><b>Ø·ÙˆÙ„ Ù‚Ù„Ø§Ø¨ Ø¨Ø¯Ù†Ù‡:</b> Ú©Ù… Ø¨ÙˆØ¯Ù† â†’ Ø§ÙØ²Ø§ÛŒØ´ ÙØ´Ø§Ø± Ù¾Ø¯Ø§Ù„Ø› Ø²ÛŒØ§Ø¯ Ø¨ÙˆØ¯Ù† â†’ Ú©Ø§Ù‡Ø´ ÙØ´Ø§Ø± Ù¾Ø¯Ø§Ù„. Ø§Ú¯Ø± Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ… ÙØ´Ø§Ø± Ù¾Ø¯Ø§Ù„ Ù‚Ù„Ø§Ø¨ Ø¨Ø¯Ù†Ù‡ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ùˆ Ù‚ÙˆØ·ÛŒ Ù…ÛŒâ€ŒÚ†Ø±Ø®Ø¯/Ù…ÛŒâ€ŒØ§ÛŒØ³ØªØ¯ØŒ Ø¯ÛŒØ³Ú© Ú©ÙˆÚ†Ú©/ÙØ±Ø³ÙˆØ¯Ù‡ Ø§Ø³Øª Ùˆ Ø¨Ø§ÛŒØ¯ Ù…ØªÙ†Ø§Ø³Ø¨ Ø³Ø§Ø®ØªÙ‡/ØªØ¹ÙˆÛŒØ¶ Ø´ÙˆØ¯.</li>
  <li><b>Ø·ÙˆÙ„ Ø¯ÙˆØ®Øª:</b> Ú©Ù… Ø¨ÙˆØ¯Ù† â†’ Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ± Ú©Ø±Ø¯Ù† Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ Ø¯ÙˆÙ… Ø¨Ù‡ Ø¯ÛŒØ³Ú© (ÙÛŒÙ„Ø± Ú©ÙˆÚ†Ú©â€ŒØªØ±). Ø²ÛŒØ§Ø¯ Ø¨ÙˆØ¯Ù† â†’ Ø¨Ø§ Ø­ÙØ¸ Ø¶Ø®Ø§Ù…Øª Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ØŒ ÙÛŒÙ„Ø± Ø¹Ù…Ù„ Ø¯ÙˆÙ… Ø¨Ø²Ø±Ú¯â€ŒØªØ± Ø´ÙˆØ¯. Ø¨Ø§Ø² Ø¨ÙˆØ¯Ù† Ø¹Ù…Ù„ Ø§ÙˆÙ„ (ÙÛŒÙ„Ø± Ø¨Ø²Ø±Ú¯) Ù†ÛŒØ² Ø·ÙˆÙ„ Ø¯ÙˆØ®Øª Ø±Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯. Ø¯Ø± ØµÙˆØ±Øª Ø¹Ø¯Ù… Ø­ØµÙˆÙ„ØŒ ØªØ¹ÙˆÛŒØ¶ Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ Ø§ÙˆÙ„ Ùˆ Ø¯ÙˆÙ….</li>
</ol>`,
`<ol class="tsList" start="5">
  <li><b>Ø¶Ø®Ø§Ù…Øª Ø¯ÙˆØ®Øª:</b> Ø²ÛŒØ§Ø¯ â†’ ÙÛŒÙ„Ø±Ú¯ÛŒØ±ÛŒ Ø¹Ù…Ù„ Ø¯ÙˆÙ… Ø¬Ø°Ø¨â€ŒØªØ±Ø› Ú©Ù… â†’ ÙÛŒÙ„Ø±Ú¯ÛŒØ±ÛŒ Ø¨Ø§Ø²ØªØ±. Ø¯Ø± ØµÙˆØ±Øª Ø¹Ø¯Ù… Ø­ØµÙˆÙ„ Ø¨Ø§ ÙˆØ¬ÙˆØ¯ Ù†Ø²Ø¯ÛŒÚ©â€ŒÚ©Ø±Ø¯Ù†ØŒ ØªØ¹ÙˆÛŒØ¶ Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ Ø¯ÙˆÙ…. Ø¯Ø± Ù…ÙˆØ§Ø±Ø¯ Ù„Ù‚ÛŒ Ø¹Ù…ÙˆØ¯ÛŒ/Ø§ÙÙ‚ÛŒ Ø´Ø§ÙØª Ùˆ Ø¨Ø§Ø²ÙˆÙ‡Ø§ØŒ Ø±ÙØ¹ Ø¹ÛŒØ¨ ØªÙˆØ³Ø· Ø§ÙØ±Ø§Ø¯ Ú©Ø§Ø±Ø¯Ø§Ù†.</li>
  <li><b>Ø¹Ù…Ù‚ Ø¯ÙˆØ®Øª:</b> ØªØ§Ø¨Ø¹ Ø²ÙˆØ§ÛŒØ§ Ùˆ Ø§Ø¨Ø¹Ø§Ø¯ Ø¯ÛŒØ³Ú© Ø§Ø³Øª Ùˆ Ú©Ù…ØªØ± Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ… Ø§ØµÙ„Ø§Ø­ Ù…ÛŒâ€ŒØ´ÙˆØ¯Ø› Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø³Ø§Ø®Øª/ØªØ¹ÙˆÛŒØ¶ Ø¯ÛŒØ³Ú© Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø¯Ø§Ø±Ø¯.</li>
</ol>`,
`<ol class="tsList" start="7">
  <li><b>Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ:</b> ØªØ§Ø¨Ø¹ Ø·ÙˆÙ„ Ù‚Ù„Ø§Ø¨â€ŒÙ‡Ø§ Ùˆ Ø·ÙˆÙ„ Ø¯ÙˆØ®Øª Ø§Ø³Øª. Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ú©Ù… â†’ Ú©Ù†ØªØ±Ù„ Ùˆ Ø±Ø³Ø§Ù†Ø¯Ù† CH Ùˆ BH Ùˆ Ø·ÙˆÙ„ Ø¯ÙˆØ®Øª Ø¨Ù‡ Ø­Ø¯ÙˆØ¯ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯Ø› Ù…ÛŒâ€ŒØªÙˆØ§Ù† Ø¨Ø§ Ú©Ø§Ù‡Ø´ Ø·ÙˆÙ„ Ø¯ÙˆØ®Øª ÛŒØ§ Ø§ÙØ²Ø§ÛŒØ´ Ù‚Ù„Ø§Ø¨â€ŒÙ‡Ø§ Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ø±Ø§ Ø¨Ø§Ù„Ø§ Ø¨Ø±Ø¯.</li>
  <li><b>ÙØ¶Ø§ÛŒ Ø¢Ø²Ø§Ø¯ Ø¨ÛŒÙ† Ù„Ø§ÛŒÙ‡â€ŒÙ‡Ø§:</b> Ø±Ø§Ø¨Ø·Ù‡ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ø§ Ø¶Ø®Ø§Ù…Øª Ø¯ÙˆØ®Øª Ø¯Ø§Ø±Ø¯Ø› Ø¨Ø§ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø´Ø¯Ù† Ø¶Ø®Ø§Ù…ØªØŒ ÙØ¶Ø§ÛŒ Ø¢Ø²Ø§Ø¯ Ù†ÛŒØ² Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</li>
</ol>`,
`<ol class="tsList" start="9">
  <li><b>Ú†Ø±Ø®ÛŒØ¯Ù†/Ø³Ø± Ø®ÙˆØ±Ø¯Ù† Ù‚ÙˆØ·ÛŒ:</b> Ø¨Ø§Ø¹Ø« Ø§ÙØ²Ø§ÛŒØ´ Ø·ÙˆÙ„ Ø¯ÙˆØ®Øª (Ø¹Ù…Ù„ Ø§ÙˆÙ„) Ùˆ Ø§ÙØ²Ø§ÛŒØ´ Ø¶Ø®Ø§Ù…Øª (Ø¹Ù…Ù„ Ø¯ÙˆÙ…) Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ Ù…Ø±Ø¯ÙˆØ¯ Ø§Ø³Øª. Ø¹Ù„Ù„: Ù†Ø²Ø¯ÛŒÚ©ÛŒ Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ù‚Ø±Ù‚Ø±Ù‡ Ø¨Ù‡ Ø¯ÛŒØ³Ú©ØŒ ÙØ±Ø³ÙˆØ¯Ú¯ÛŒ Ø¯ÛŒØ³Ú©ØŒ ÙØ´Ø§Ø± Ù¾Ø¯Ø§Ù„ Ú©Ù….</li>
  <li><b>ØºÛŒØ±ÛŒÚ©Ù†ÙˆØ§Ø®ØªÛŒ ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ÛŒ Ø¯ÙˆØ®Øª:</b> Ù†Ø§Ø´ÛŒ Ø§Ø² ØªÙ†Ø¸ÛŒÙ… Ù†Ø§Ù…Ù†Ø§Ø³Ø¨ (ÛŒÚ©ÛŒ Ø¬Ù„ÙˆØªØ±/Ø¹Ù‚Ø¨â€ŒØªØ±)ØŒ Ù„Ù†Ú¯ÛŒ Ø¯ÛŒØ³Ú©/Ø´Ø§ÙØªØŒ Ø¨Ø²Ø±Ú¯ Ø¨ÙˆØ¯Ù† Ø¯ÛŒØ³Ú© Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø¯Ø±Ø¨ØŒ Ú©Ø¬ÛŒ Ø³Ø·Ø­ Ù¾Ø¯Ø§Ù„. Ø¨Ø§ÛŒØ¯ ØªÚ©â€ŒØªÚ© Ø¨Ø±Ø±Ø³ÛŒ Ùˆ Ø±ÙØ¹ Ø´ÙˆØ¯.</li>
</ol>`,
`<ol class="tsList" start="11">
  <li><b>ØªÛŒØ²ÛŒØŒ Ù¾Ù„Ù‡ ÛŒØ§ Ø¨Ø±ÛŒØ¯Ú¯ÛŒ Ø¯ÙˆØ®Øª:</b> Ø§Ø² ØªÙ†Ø¸ÛŒÙ… ØºÙ„Ø· Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø¯ÛŒØ³Ú© (Ø§Ø±ØªÙØ§Ø¹ÛŒ/Ø§ÙÙ‚ÛŒ)ØŒ ÙØ´Ø§Ø± Ù¾Ø¯Ø§Ù„ Ø²ÛŒØ§Ø¯ØŒ ÛŒØ§ ÙØ±Ø³ÙˆØ¯Ú¯ÛŒ Ø¯ÛŒØ³Ú© Ù†Ø§Ø´ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ù…ÙˆØ§Ø±Ø¯ Ø±Ø§ ØªØ´Ø®ÛŒØµ Ùˆ Ø§ØµÙ„Ø§Ø­ Ú©Ù†ÛŒØ¯.</li>
  <li><b>Ø¨Ø±ÛŒØ¯Ú¯ÛŒ Ø§Ø² Ù¾Ø§ÛŒÛŒÙ† Ø¯ÙˆØ®Øª:</b> ÙˆÙ‚ØªÛŒ Ø¹Ù…Ù„ Ø§ÙˆÙ„ Ø§Ø² Ù†Ø¸Ø± Ø¹Ù…ÙˆØ¯ÛŒ ÛŒÚ©ÛŒ Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ± Ùˆ ÛŒÚ©ÛŒ Ø¨Ø§Ù„Ø§ØªØ± Ø¨Ø§Ø´Ø¯ ÛŒØ§ ÙØ§ØµÙ„Ù‡ Ø§ÙÙ‚ÛŒ Ø²ÛŒØ§Ø¯ Ø¨Ø§Ø´Ø¯ØŒ Ø®Ø· Ùˆ Ø¨Ø±ÛŒØ¯Ú¯ÛŒ Ø§Ø² Ø²ÛŒØ± Ø±Ø® Ù…ÛŒâ€ŒØ¯Ù‡Ø¯. Ø¨Ø§Ø±ÛŒÚ© Ø¨ÙˆØ¯Ù† Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ Ø§ÙˆÙ„ Ù†ÛŒØ² Ù…Ø¤Ø«Ø± Ø§Ø³Øª.</li>
</ol>`,
`<ol class="tsList" start="13">
  <li><b>Ù¾Ø§ÛŒÛŒÙ† Ø§ÙØªØ§Ø¯Ú¯ÛŒ (Ø¯Ø§Ø®Ù„ÛŒ/Ø®Ø§Ø±Ø¬ÛŒ):</b> Ø§Ø² Ø¨Ø§Ø² Ø¨ÙˆØ¯Ù† Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø¯ÛŒØ³Ú©ØŒ ÙØ±Ø³ÙˆØ¯Ú¯ÛŒ ÛŒØ§ Ú¯ÛŒØ± Ú©Ø±Ø¯Ù† Ø¨Ù„Ø¨Ø±ÛŒÙ†Ú¯ Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ Ù†Ø§Ø´ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø¶Ø±Ø¨Ù‡ Ø¨Ù‡ Ø¯Ø±Ø¨ Ø¯Ø± Ú©Ø§Ù†Ø§Ù„ Ø§Ù†ØªÙ‚Ø§Ù„ Ù†ÛŒØ² Ø³Ø¨Ø¨ Ù†Ù‚Ø§Ø·ÛŒ Ø§Ø² Ù¾Ø§ÛŒÛŒÙ†â€ŒØ§ÙØªØ§Ø¯Ú¯ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</li>
  <li><b>Ú†ÛŒÙ† Ùˆ Ú†Ø±ÙˆÚ© Ù‚Ù„Ø§Ø¨ Ø³Ø±:</b> Ø¨Ø§ Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ± Ú©Ø±Ø¯Ù† Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ Ø¯ÙˆÙ… Ø¨Ù‡ Ø¯ÛŒØ³Ú© Ø§ØµÙ„Ø§Ø­ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø¯Ø± ØµÙˆØ±Øª Ø¹Ø¯Ù… Ø§ØµÙ„Ø§Ø­ØŒ ØªØ¹ÙˆÛŒØ¶ Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ Ø¯ÙˆÙ…. Ú©ÙˆÚ†Ú© Ø¨ÙˆØ¯Ù† Ø¯ÛŒØ³Ú© Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø¯Ø±Ø¨ Ù†ÛŒØ² Ø¹Ø§Ù…Ù„ Ú†Ø±ÙˆÚ© Ø§Ø³Øª.</li>
</ol>`,
`<ol class="tsList" start="15">
  <li><b>Ù¾ÛŒÚ©/Ø¯Ú©Ù…Ù‡ Ø²Ø¯Ù† Ø¯ÙˆØ®Øª:</b> Ù†Ø§Ø´ÛŒ Ø§Ø² Ú¯ÛŒØ±Ú©Ø±Ø¯Ù† Ø­Ø±Ú©Øª Ú†Ø±Ø®Ø´ÛŒ Ø¨Ù„Ø¨Ø±ÛŒÙ†Ú¯ Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ØŒ Ù„Ù‚ÛŒ Ø¹Ù…ÙˆØ¯ÛŒØŒ ÛŒØ§ Ø¶Ø±Ø¨Ù‡ Ø¯Ø± Ù…Ø³ÛŒØ± ÙÛŒØ¯Ø±/Ú©Ø§Ù†Ø§Ù„â€ŒÙ‡Ø§. Ù†Ù‚Ø§Ø· Ø¶Ø±Ø¨â€ŒØ¯ÛŒØ¯Ù‡ Ø¯ÙˆØ®Øª Ù†Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ Ùˆ Ø¨ÛŒØ±ÙˆÙ†â€ŒØ²Ø¯Ú¯ÛŒ Ø¯ÛŒØ¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø§Ú¯Ø± Ú†Ù†Ø¯Ù†Ù‚Ø·Ù‡â€ŒØ§ÛŒ Ø¨Ø§Ø´Ø¯ Ø§Ø² Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ Ùˆ ÙØ±Ø³ÙˆØ¯Ú¯ÛŒ Ø´Ø¯ÛŒØ¯ Ø§Ø³Øª.</li>
  <li><b>Ú¯ÛŒØ± Ú©Ø±Ø¯Ù† Ù‚ÙˆØ·ÛŒ Ùˆ Ø¯Ø±Ø¨ Ø¨Ù‡ Ø¯ÛŒØ³Ú©:</b> Ø§Ø² ÙØ±Ø³ÙˆØ¯Ú¯ÛŒ Ø´Ø¯ÛŒØ¯ Ø¯ÛŒØ³Ú©ØŒ Ù†Ø²Ø¯ÛŒÚ©ÛŒ Ø¨ÛŒØ´ Ø§Ø² Ø­Ø¯ Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ØŒ Ø§Ø®ØªÙ„Ø§Ù Ø²ÛŒØ§Ø¯ ÙØ§ØµÙ„Ù‡ Ø¹Ù…ÙˆØ¯ÛŒ Ù‚Ø±Ù‚Ø±Ù‡ Ø¨Ø§ Ø¯ÛŒØ³Ú©ØŒ ÛŒØ§ Ø¨Ø²Ø±Ú¯ Ø¨ÙˆØ¯Ù† Ø¯ÛŒØ³Ú© Ù†Ø³Ø¨Øª Ø¨Ù‡ Ø¯Ø±Ø¨ Ù†Ø§Ø´ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</li>
  <li><b>Ø¯ÙˆØ®Øª Ù†Ø§Ù‚Øµ:</b> Ù‡Ù…â€ŒÙ…Ø±Ú©Ø² Ù†Ø¨ÙˆØ¯Ù† Ø¯Ø±Ø¨ Ùˆ Ù‚ÙˆØ·ÛŒØŒ Ø¶Ø±Ø¨â€ŒØ¯ÛŒØ¯Ú¯ÛŒ Ø¯Ø±Ø¨/Ù‚ÙˆØ·ÛŒØŒ Ø¨ÛŒØ¶ÛŒ Ø´Ø¯Ù† Ù‚ÙˆØ·ÛŒØŒ ÛŒØ§ ØªØ§ÛŒÙ… ØºÙ„Ø· Ø³ØªØ§Ø±Ù‡â€ŒÙ‡Ø§/Ø§Ù†Ú¯Ø´ØªÛŒâ€ŒÙ‡Ø§ Ù†Ø³Ø¨Øª Ø¨Ù‡ Ù¾Ø¯Ø§Ù„. Ø¨Ø§ÛŒØ¯ ØªÙ†Ø¸ÛŒÙ… Ø´ÙˆÙ†Ø¯ ØªØ§ Ø§Ø² Ø²Ø§ÙˆÛŒÙ‡ Û¹Û° Ø¯Ø±Ø¬Ù‡ Ú©Ø§Ù…Ù„Ø§Ù‹ Ù‡Ù…â€ŒÙ…Ø±Ú©Ø² Ø¨Ø§Ø´Ù†Ø¯Ø› Ù‚Ø·Ø¹Ø§Øª ÙØ±Ø³ÙˆØ¯Ù‡ ØªØ¹ÙˆÛŒØ¶ Ø´ÙˆÙ†Ø¯.</li>
</ol>`,
`<ol class="tsList" start="17">
  <li><b>Ú†ÛŒÙ†â€ŒØ®ÙˆØ±Ø¯Ú¯ÛŒ Ùˆ ØªØ§Ø®ÙˆØ±Ø¯Ú¯ÛŒ:</b> ØªØ§Ø®ÙˆØ±Ø¯Ú¯ÛŒ Ùˆ Ø¨Ø±Ú¯Ø´ØªÚ¯ÛŒ Ù‚Ù„Ø§Ø¨ Ø³Ø± Ø¯Ø± Ù…Ø±Ø­Ù„Ù‡ Ø§ÙˆÙ„ Ø§ÛŒØ¬Ø§Ø¯ Ù…ÛŒâ€ŒØ´ÙˆØ¯Ø› Ø¹Ù„Ù„: Ú¯ÛŒØ±Ù¾Ø§Ú† Ø¨Ù„Ø¨Ø±ÛŒÙ†Ú¯ Ù‚Ø±Ù‚Ø±Ù‡â€ŒÙ‡Ø§ØŒ Ø¶Ø±Ø¨â€ŒØ¯ÛŒØ¯Ú¯ÛŒ Ø¯Ø±Ø¨ØŒ ØªÙ†Ø¸ÛŒÙ… Ù†Ø§Ù…Ù†Ø§Ø³Ø¨/ÙØ±Ø³ÙˆØ¯Ú¯ÛŒ ØªÛŒØºÙ‡â€ŒÙ‡Ø§ÛŒ ÙÛŒØ¯Ø± Ø¯Ø±Ø¨. Ú†ÛŒÙ†â€ŒØ®ÙˆØ±Ø¯Ú¯ÛŒ Ø­Ø§Ù„Øª Ø¨ÛŒÙ† Ú†Ø±ÙˆÚ© Ùˆ ØªØ§Ø®ÙˆØ±Ø¯Ú¯ÛŒ Ø§Ø³Øª.</li>
</ol>`
];

/* --- Ø¬Ø³ØªØ¬ÙˆÛŒ Ø²Ù†Ø¯Ù‡ + Ù‡Ø§ÛŒÙ„Ø§ÛŒØª --- */
let tsIndex = 0;               // Ø§Ù†Ø¯ÛŒØ³ ØµÙØ­Ù‡Ù” ÙØ¹Ù„ÛŒ (Ø¯Ø± Ú©Ù„ ØµÙØ­Ø§Øª)
let matchedPages = null;       // Ø¢Ø±Ø§ÛŒÙ‡Ù” Ø§Ù†Ø¯ÛŒØ³ ØµÙØ­Ø§ØªÛŒ Ú©Ù‡ Ø¨Ø§ Ø¬Ø³ØªØ¬Ùˆ match Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯Ø› null ÛŒØ¹Ù†ÛŒ Ù‡Ù…Ù‡Ù” ØµÙØ­Ø§Øª
let searchTerm = '';           // Ø¹Ø¨Ø§Ø±Øª Ø¬Ø³ØªØ¬Ùˆ (Ú©ÙˆÚ†Ú©â€ŒØ³Ø§Ø²ÛŒâ€ŒØ´Ø¯Ù‡)

function openTroubleshooting(){
  tsIndex = 0; matchedPages = null; searchTerm = '';
  document.getElementById('tsSearch').value = '';
  renderTsPage();
  document.getElementById('tsOverlay').style.display = 'flex';
  document.getElementById('tsOverlay').setAttribute('aria-hidden','false');
  setTimeout(()=>document.getElementById('tsSearch').focus(), 50);
}
function closeTroubleshooting(){
  document.getElementById('tsOverlay').style.display = 'none';
  document.getElementById('tsOverlay').setAttribute('aria-hidden','true');
}

function getActivePages(){
  // Ø§Ú¯Ø± Ø¬Ø³ØªØ¬Ùˆ ÙØ¹Ø§Ù„ Ø§Ø³ØªØŒ ÙÙ‚Ø· ØµÙØ­Ø§Øª matchâ€ŒØ´Ø¯Ù‡ Ø±Ø§ Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø› Ø¯Ø± ØºÛŒØ± Ø§ÛŒÙ†â€ŒØµÙˆØ±Øª Ù‡Ù…Ù‡Ù” ØµÙØ­Ø§Øª
  if (matchedPages && matchedPages.length) return matchedPages;
  return tsPages.map((_,i)=>i);
}

function highlightHTML(html, term){
  if(!term) return html;
  // Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§ÛŒ Ø®Ø§Øµ regex Ø±Ø§ escape Ú©Ù†ÛŒÙ…
  const esc = term.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
  const re = new RegExp(`(${esc})`, 'gi');
  // Ø¨Ø±Ø§ÛŒ Ø§ÛŒÙ†Ú©Ù‡ Ø¯Ø§Ø®Ù„ ØªÚ¯â€ŒÙ‡Ø§ÛŒ HTML Ù‡Ø§ÛŒÙ„Ø§ÛŒØª Ù†Ø´ÙˆØ¯ØŒ Ø³Ø§Ø¯Ù‡â€ŒØªØ±ÛŒÙ† Ø±ÙˆØ´ split Ø±ÙˆÛŒ Ù…ØªÙ† Ø§Ø³Øª:
  // Ú†ÙˆÙ† Ù…Ø­ØªÙˆØ§ Ú©ÙˆØªØ§Ù‡ Ø§Ø³ØªØŒ Ø±ÙˆÛŒÚ©Ø±Ø¯ replace Ù…Ø³ØªÙ‚ÛŒÙ… Ú©ÙØ§ÛŒØª Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
  return html.replace(re, '<span class="hl">$1</span>');
}

function renderTsPage(){
  const pages = getActivePages();
  if (pages.length === 0){
    document.getElementById('tsContent').innerHTML = `<p>Ù†ØªÛŒØ¬Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>`;
    document.getElementById('tsPageIndicator').textContent = `Û° Ù†ØªÛŒØ¬Ù‡`;
    document.getElementById('tsPrev').disabled = true;
    document.getElementById('tsNext').disabled = true;
    return;
  }

  // Ø§Ú¯Ø± tsIndex Ø®Ø§Ø±Ø¬ Ø§Ø² Ù…Ø­Ø¯ÙˆØ¯Ù‡Ù” pages Ø¨Ø§Ø´Ø¯ØŒ Ø¢Ù† Ø±Ø§ Ø§ØµÙ„Ø§Ø­ Ú©Ù†
  if (!pages.includes(tsIndex)) tsIndex = pages[0];

  const contentEl = document.getElementById('tsContent');
  const rawHTML = tsPages[tsIndex];
  contentEl.innerHTML = searchTerm ? highlightHTML(rawHTML, searchTerm) : rawHTML;

  const currentPos = pages.indexOf(tsIndex) + 1;
  document.getElementById('tsPageIndicator').textContent = `ØµÙØ­Ù‡ ${currentPos} Ø§Ø² ${pages.length}`;
  document.getElementById('tsPrev').disabled = currentPos === 1;
  document.getElementById('tsNext').disabled = currentPos === pages.length;
}

function gotoPrev(){
  const pages = getActivePages();
  const pos = pages.indexOf(tsIndex);
  if (pos > 0){ tsIndex = pages[pos-1]; renderTsPage(); }
}
function gotoNext(){
  const pages = getActivePages();
  const pos = pages.indexOf(tsIndex);
  if (pos < pages.length-1){ tsIndex = pages[pos+1]; renderTsPage(); }
}

document.getElementById('tsPrev').addEventListener('click', gotoPrev);
document.getElementById('tsNext').addEventListener('click', gotoNext);
document.getElementById('tsClose').addEventListener('click', closeTroubleshooting);
document.getElementById('tsOverlay').addEventListener('click', (e)=>{ if(e.target.id==='tsOverlay') closeTroubleshooting(); });

// Ø¬Ø³ØªØ¬ÙˆÛŒ Ø²Ù†Ø¯Ù‡ Ø¨Ø§ debounce Ø³Ø¨Ú©
let tsSearchTimer = null;
document.getElementById('tsSearch').addEventListener('input', (e)=>{
  const value = e.target.value.trim();
  clearTimeout(tsSearchTimer);
  tsSearchTimer = setTimeout(()=>{
    searchTerm = value;
    if(!searchTerm){
      matchedPages = null; // Ù‡Ù…Ù‡Ù” ØµÙØ­Ø§Øª
      // tsIndex Ø±Ø§ Ø±ÙˆÛŒ Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ±ÛŒÙ† ØµÙØ­Ù‡Ù” Ù‚Ø¨Ù„ÛŒ Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒÙ…
      renderTsPage();
      return;
    }
    const s = searchTerm.toLowerCase();
    matchedPages = tsPages
      .map((html, i) => ({ i, hit: html.toLowerCase().includes(s) }))
      .filter(x => x.hit)
      .map(x => x.i);

    // Ø§Ú¯Ø± ØµÙØ­Ù‡Ù” ÙØ¹Ù„ÛŒ Ø¯Ø§Ø®Ù„ Ù†ØªØ§ÛŒØ¬ Ù†ÛŒØ³ØªØŒ Ø¨Ø±Ùˆ Ø¨Ù‡ Ø§ÙˆÙ„ÛŒÙ† Ù†ØªÛŒØ¬Ù‡
    if (!matchedPages.includes(tsIndex)) tsIndex = matchedPages[0] || 0;
    renderTsPage();
  }, 120);
});

document.getElementById('tsClear').addEventListener('click', ()=>{
  document.getElementById('tsSearch').value = '';
  searchTerm = ''; matchedPages = null; renderTsPage();
});

/* Ø´Ø±ÙˆØ¹ */
updateProgress();
</script>

</body>
</html>

