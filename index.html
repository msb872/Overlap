
<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <title> Overlap %</title>
  <style>
    body {
      font-family: Tahoma, sans-serif;
      direction: rtl;
      background-color: #f7f9fc;
      margin: 20px;
      color: #333;
    }
    h2 { margin-bottom: 10px; }
    .info-text { font-size: 13px; color: #555; margin-bottom: 10px; }
    .input-row {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 15px;
      align-items: center;
    }
    .input-row label {
      font-size: 13px;
      display: flex;
      flex-direction: column;
      width: 140px;
    }
    .input-row input {
      padding: 6px 8px;
      font-size: 14px;
      border: 1px solid #bbb;
      border-radius: 4px;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      background-color: #007bff;
      border: none;
      color: white;
      padding: 8px 18px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: 0.3s;
      height: 38px;
      align-self: flex-end;
    }
    button:hover { background-color: #0056b3; }
    .table-container { overflow-x: auto; margin-top: 10px; }
    table {
      min-width: 700px;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 0 8px rgba(0, 0, 0, 0.1);
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px 12px;
      text-align: center;
      font-size: 14px;
    }
    th { background-color: #f0f0f0; font-weight: 600; }
    tbody tr:hover { background-color: #f5faff; }
    #warnings { margin-top: 12px; font-size: 14px; }
    #warnings ul { list-style: none; padding: 0; }
    #warnings li {
      background: #fff3f3;
      border: 1px solid #ffcccc;
      padding: 6px 10px;
      margin-bottom: 5px;
      border-radius: 4px;
      color: #c00;
    }
    #printBtn, #saveBtn {
      position: fixed;
      left: 20px;
      border: none;
      color: white;
      padding: 10px 18px;
      border-radius: 50px;
      font-size: 14px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.3);
      z-index: 999;
      cursor: pointer;
    }
    #printBtn { bottom: 20px; background-color: #28a745; }
    #printBtn:hover { background-color: #1e7e34; }
    #saveBtn { bottom: 70px; background: #ff9800; }
    #saveBtn:hover { background: #e68900; }
  </style>
</head>
<body>

<h2>Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ù‚ÙˆØ·ÛŒ ÙÙ„Ø²ÛŒ- ØªÙ‡ÛŒÙ‡ Ú©Ù†Ù†Ø¯Ù‡: Ù…ØµÛŒØ¨ Ø®Ø§Ù†ÛŒ Ú©Ø§Ø±Ø´Ù†Ø§Ø³ Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒØª Ú©Ø§Ø±Ø®Ø§Ù†Ù‡ Ø¯Ø´Øª Ù…Ø±ØºØ§Ø¨</h2>
<p class="info-text">ğŸ”¹ ØªÙ…Ø§Ù… Ù…Ù‚Ø§Ø¯ÛŒØ± ÙˆØ±ÙˆØ¯ÛŒ Ø¨Ø± Ø­Ø³Ø¨<strong>0.001 Ø§ÛŒÙ†Ú†</strong> Ù‡Ø³ØªÙ†Ø¯.</p>

<div class="input-row">
  <label>Ø·ÙˆÙ„ Ø¯ÙˆØ®Øª-SL
    <input type="number" id="length" min="0" step="0.01"/>
  </label>
  <label>Ø¶Ø®Ø§Ù…Øª Ø¯ÙˆØ®Øª-ST
    <input type="number" id="seamThickness" min="0" step="0.01"/>
  </label>
  <label>Ù‚Ù„Ø§Ø¨ Ø¯Ø±Ø¨-CH
    <input type="number" id="coverHook" min="0" step="0.01"/>
  </label>
  <label>Ù‚Ù„Ø§Ø¨ Ø¨Ø¯Ù†Ù‡-BH
    <input type="number" id="bodyHook" min="0" step="0.01"/>
  </label>
  <label>Ø¶Ø®Ø§Ù…Øª ÙˆØ±Ù‚ Ø³Ø±- Te
    <input type="number" id="headThickness" min="0" step="0.01"/>
  </label>
  <label>Ø¶Ø®Ø§Ù…Øª ÙˆØ±Ù‚ Ø¨Ø¯Ù†Ù‡- Tb
    <input type="number" id="bodyThickness" min="0" step="0.01"/>
  </label>
  <button onclick="addTemplate()">â• Ù…Ø­Ø§Ø³Ø¨Ù‡ </button>
</div>

<div class="table-container">
  <table id="resultsTable">
    <thead>
      <tr id="headerRow">
        <th>ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§</th>
        <th>Ù‚Ø§Ù„Ø¨ 1</th>
      </tr>
    </thead>
    <tbody id="tableBody">
      <tr><td>Ø·ÙˆÙ„ Ø¯ÙˆØ®Øª (Seam Length)</td></tr>
<tr><td>Ø¶Ø®Ø§Ù…Øª Ø¯ÙˆØ®Øª (Seam Thickness)</td></tr>
<tr><td>Ù‚Ù„Ø§Ø¨ Ø¯Ø±Ø¨ (Cover Hook)</td></tr>
<tr><td>Ù‚Ù„Ø§Ø¨ Ø¨Ø¯Ù†Ù‡ (Body Hook)</td></tr>
<tr><td>Ø¶Ø®Ø§Ù…Øª ÙˆØ±Ù‚ Ø³Ø± (End Thickness)</td></tr>
<tr><td>Ø¶Ø®Ø§Ù…Øª ÙˆØ±Ù‚ Ø¨Ø¯Ù†Ù‡ (Body Thickness)</td></tr>
<tr><td>Ø§Ø®ØªÙ„Ø§Ù Ù‚Ù„Ø§Ø¨ (Hook Difference)</td></tr>
<tr><td>ÙØ¶Ø§ÛŒ Ø¢Ø²Ø§Ø¯ (Free Space)</td></tr>
<tr><td>Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ (Overlap %)</td></tr>
<tr><td>Ú†Ø±ÙˆÚ©ÛŒØ¯Ú¯ÛŒ Ù‚Ù„Ø§Ø¨ Ø¯Ø±Ø¨ (Cover Hook Wrinkle)</td></tr>
<tr><td>ØªÛŒØ²Ú©Ø±Ø¯Ú¯ÛŒ Ø¯ÙˆØ®Øª (Seam Sharpness)</td></tr>

    </tbody>
  </table>
</div>

<div id="warnings"><strong>âš ï¸ Ù‡Ø´Ø¯Ø§Ø±Ù‡Ø§:</strong><ul id="warningList"></ul></div>

<button id="printBtn" onclick="printReport()">ğŸ–¨ï¸ Ù¾Ø±ÛŒÙ†Øª</button>
<button id="saveBtn" onclick="saveAsHTML()">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ HTML</button>

<script>
  let templateCount = 1;

  function addTemplate() {
    const inputs = ['length','seamThickness','coverHook','bodyHook','headThickness','bodyThickness']
      .map(id => parseFloat(document.getElementById(id).value));

    if (inputs.some(v => isNaN(v) || v < 0)) {
      alert('Ù„Ø·ÙØ§Ù‹ Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ø¨Ø§ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø¹Ø¯Ø¯ÛŒ Ù…Ø«Ø¨Øª Ù¾Ø± Ú©Ù†ÛŒØ¯.');
      return;
    }

    const [length,seamThickness,coverHook,bodyHook,headThickness,bodyThickness] = inputs;

    const hookDiff = Math.abs(coverHook - bodyHook);
    const freeSpace = Math.abs(seamThickness - (3 * headThickness + 2 * bodyThickness));
    const denominator = length - (2.2 * headThickness + 1.1 * bodyThickness);
    let overlap = 0;
    if (denominator !== 0) {
      overlap = Math.abs((length - (coverHook + bodyHook + 1.1 * headThickness)) / denominator * 100);
    }

    if (templateCount > 1) {
      const newHeader = document.createElement('th');
      newHeader.textContent = `Ù‚Ø§Ù„Ø¨ ${templateCount}`;
      document.getElementById('headerRow').appendChild(newHeader);
    }

    const values = [
      length.toFixed(2),
      seamThickness.toFixed(2),
      coverHook.toFixed(2),
      bodyHook.toFixed(2),
      headThickness.toFixed(2),
      bodyThickness.toFixed(2),
      hookDiff.toFixed(2),
      freeSpace.toFixed(2),
      overlap.toFixed(2),
      '-',
      '-'
    ];

    const rows = document.querySelectorAll('#tableBody tr');
    rows.forEach((row, i) => {
      const td = document.createElement('td');
      td.textContent = values[i];
      td.style.color = '';
      row.appendChild(td);
    });

    const col = templateCount;

    let warningsForCurrentTemplate = [];

    if (overlap < 45) {
      rows[8].children[col].style.color = 'red';
      warningsForCurrentTemplate.push('Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ú©Ù…ØªØ± Ø§Ø² 45Ùª Ø§Ø³Øª');
    }
    if (hookDiff > 7.8) {
      rows[6].children[col].style.color = 'red';
      warningsForCurrentTemplate.push('Ø§Ø®ØªÙ„Ø§Ù Ù‚Ù„Ø§Ø¨ Ø¨ÛŒØ´ØªØ± Ø§Ø² 7.8 Ø§Ø³Øª');
    }
    if (freeSpace > 7.5) {
      rows[7].children[col].style.color = 'red';
      warningsForCurrentTemplate.push('ÙØ¶Ø§ÛŒ Ø¢Ø²Ø§Ø¯ Ø¨ÛŒØ´ØªØ± Ø§Ø² 7.5 Ø§Ø³Øª');
    }
    if (coverHook < 70) {
      rows[2].children[col].style.color = 'red';
      warningsForCurrentTemplate.push('Ù‚Ù„Ø§Ø¨ Ø¯Ø±Ø¨ Ú©Ù…ØªØ± Ø§Ø² 70 Ø§Ø³Øª');
    }
    if (bodyHook < 70) {
      rows[3].children[col].style.color = 'red';
      warningsForCurrentTemplate.push('Ù‚Ù„Ø§Ø¨ Ø¨Ø¯Ù†Ù‡ Ú©Ù…ØªØ± Ø§Ø² 70 Ø§Ø³Øª');
    }

    if (warningsForCurrentTemplate.length > 0) {
      const warningList = document.getElementById('warningList');
      const li = document.createElement('li');
      li.textContent = `Ù‚Ø§Ù„Ø¨ ${col}: ${warningsForCurrentTemplate.join('ØŒ ')}`;
      warningList.appendChild(li);
    }

    document.getElementById('length').value = '';
    document.getElementById('seamThickness').value = '';
    document.getElementById('coverHook').value = '';
    document.getElementById('bodyHook').value = '';
    document.getElementById('length').focus();

    templateCount++;
  }

  function getReportHTML(reporterName) {
    const tableHTML = document.getElementById("resultsTable").outerHTML;
    const warningsHTML = document.getElementById("warnings").outerHTML;
    return `
    <html lang="fa" dir="rtl">
      <head>
        <meta charset="UTF-8">
        <title>Ú¯Ø²Ø§Ø±Ø´ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù‚Ø§Ù„Ø¨</title>
        <style>
          body { font-family: Tahoma, sans-serif; direction: rtl; padding: 20px; }
          table { border-collapse: collapse; width: 100%; margin-top: 10px; }
          th, td { border: 1px solid #000; padding: 6px; text-align: center; }
          h3 { text-align: center; }
          .footer { margin-top: 20px; font-size: 14px; text-align: left; }
        </style>
      </head>
      <body>
        <h3>Ú¯Ø²Ø§Ø±Ø´ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù‚Ø§Ù„Ø¨</h3>
        <p><strong>ØªØ§Ø±ÛŒØ®:</strong> ${new Date().toLocaleDateString("fa-IR")}</p>
        ${tableHTML}
        ${warningsHTML}
        <div class="footer"><strong>Ú¯Ø²Ø§Ø±Ø´Ú¯Ø±:</strong> ${reporterName}</div>
      </body>
    </html>`;
  }

  function printReport() {
    let reporterName = prompt("Ù†Ø§Ù… Ú¯Ø²Ø§Ø±Ø´Ú¯Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:", "Ù…Ù‡Ù†Ø¯Ø³ Ø®Ø§Ù†ÛŒ");
    if (!reporterName) reporterName = "Ù…Ù‡Ù†Ø¯Ø³ Ø®Ø§Ù†ÛŒ";

    const content = getReportHTML(reporterName);
    const newWin = window.open("", "_blank");
    newWin.document.write(content);
    newWin.document.close();
    newWin.print();
  }

  function saveAsHTML() {
    let reporterName = prompt("Ù†Ø§Ù… Ú¯Ø²Ø§Ø±Ø´Ú¯Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:", "Ù…Ù‡Ù†Ø¯Ø³ Ø®Ø§Ù†ÛŒ");
    if (!reporterName) reporterName = "Ù…Ù‡Ù†Ø¯Ø³ Ø®Ø§Ù†ÛŒ";

    const content = getReportHTML(reporterName);
    const blob = new Blob([content], { type: "text/html" });
    const url = URL.createObjectURL(blob);

    const link = document.createElement("a");
    link.href = url;
    link.download = `Ú¯Ø²Ø§Ø±Ø´_${new Date().toLocaleDateString("fa-IR")}.html`;
    link.click();

    URL.revokeObjectURL(url);
  }
</script>
</body>
</html>
