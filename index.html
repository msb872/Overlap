<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ø¯Ø±Ø¨Ù†Ø¯ÛŒ Ù‚ÙˆØ·ÛŒ ÙÙ„Ø²ÛŒ</title>
  <style>
    body {
      font-family: Tahoma, sans-serif;
      background: linear-gradient(to bottom, #eef2f7, #ffffff);
      margin: 0; padding: 20px;
      color: #333;
    }
    header { background-color: #0077b6; color: #fff; padding: 2px; border-radius: 8px; text-align: center; margin-bottom: 10px; }
    .info-text { font-size: 12px; text-align: center; margin-bottom: 10px; }
    .input-row { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-bottom: 25px; }
    .input-row label { font-size: 12px; display: flex; flex-direction: column; width: 160px; background: #fff; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);}
    .input-row input { margin-top: 6px; padding: 6px 8px; font-size: 14px; border: 1px solid #bbb; border-radius: 4px; }
    .input-row button { align-self: flex-end; background-color: #0077b6; border: none; color: white; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 14px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); transition: 0.2s; margin-top: 24px; }
    .input-row button:hover { background-color: #005f99; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; background: #fff; box-shadow: 0 0 8px rgba(0,0,0,0.1); }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: center; font-size: 14px; }
    th { background-color: #f0f4f8; font-weight: bold; }
    tbody tr:hover { background-color: #f1f9ff; }
    #warnings { margin-top: 20px; }
    #warnings ul { list-style: none; padding: 0; }
    #warnings li { background: #fff3f3; border: 1px solid #ffcccc; padding: 8px 12px; margin-bottom: 6px; border-radius: 5px; color: #c00; font-size: 14px; }
    .footer-buttons { position: fixed; left: 25px; bottom: 25px; display: flex; flex-direction: column; gap: 5px; }
    .footer-buttons button { width: 130px; background-color: #0077b6; border: none; color: #fff; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 14px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); transition: 0.2s; }
    .footer-buttons button:hover { background-color: #000f99; }

    .help-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 1000; }
    .help-box { background: #fff; width: 340px; padding: 20px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); text-align: right; font-family: Tahoma; animation: popIn 0.3s ease; }
    .help-box h3 { text-align: center; margin-bottom: 10px; color: #0077b6; }
    .help-box ul { padding-right: 20px; font-size: 14px; line-height: 1.7; }
    .help-box button { background: #0077b6; color: white; padding: 6px 14px; border: none; border-radius: 6px; cursor: pointer; display: block; margin: 10px auto 0; }
    @keyframes popIn { from { transform: scale(0.7); opacity: 0; } to { transform: scale(1); opacity: 1; } }
  </style>
</head>
<body>

<header>
  <h2>Ø¨Ø±Ù†Ø§Ù…Ù‡ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ù‚ÙˆØ·ÛŒ ÙÙ„Ø²ÛŒ v1.01</h2>
  <p>ØªÙ‡ÛŒÙ‡â€ŒÚ©Ù†Ù†Ø¯Ù‡: Ù…ØµÛŒØ¨ Ø®Ø§Ù†ÛŒ - Ú©Ø§Ø±Ø´Ù†Ø§Ø³ Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒØª</p>
</header>

<p class="info-text">
  ğŸ”¹ ØªÙ…Ø§Ù… Ù…Ù‚Ø§Ø¯ÛŒØ± ÙˆØ±ÙˆØ¯ÛŒ Ø¨Ø± Ø­Ø³Ø¨ <strong>0.001 Ø§ÛŒÙ†Ú†</strong> Ù‡Ø³ØªÙ†Ø¯Ø›
  Ù…Ù‚Ø§Ø¯ÛŒØ± Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ± Ø¨Ù‡ ØµÙˆØ±Øª Ù…Ú©Ù…Ù„ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ ğŸ”¹
</p>

<div class="input-row">
  <label>Ø·ÙˆÙ„ Ø¯ÙˆØ®Øª-SL<input type="number" id="length" min="0" step="0.01"></label>
  <label>Ø¶Ø®Ø§Ù…Øª Ø¯ÙˆØ®Øª-ST<input type="number" id="seamThickness" min="0" step="0.01"></label>
  <label>Ù‚Ù„Ø§Ø¨ Ø¯Ø±Ø¨-CH<input type="number" id="coverHook" min="0" step="0.01"></label>
  <label>Ù‚Ù„Ø§Ø¨ Ø¨Ø¯Ù†Ù‡-BH<input type="number" id="bodyHook" min="0" step="0.01"></label>
  <label>Ø¶Ø®Ø§Ù…Øª ÙˆØ±Ù‚ Ø³Ø±-Te<input type="number" id="headThickness" min="0" step="0.01"></label>
  <label>Ø¶Ø®Ø§Ù…Øª ÙˆØ±Ù‚ Ø¨Ø¯Ù†Ù‡-Tb<input type="number" id="bodyThickness" min="0" step="0.01"></label>
  <button onclick="addTemplate()">â• Ù…Ø­Ø§Ø³Ø¨Ù‡/Ø¬Ø¯ÛŒØ¯</button>
</div>

<table id="resultsTable">
  <thead>
    <tr id="headerRow">
      <th>ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§</th>
      <th>Ù‚Ø§Ù„Ø¨ 1</th>
    </tr>
  </thead>
  <tbody id="tableBody">
    <tr><td>Ø·ÙˆÙ„ Ø¯ÙˆØ®Øª (Seam Length)</td></tr>
    <tr><td>Ø¶Ø®Ø§Ù…Øª Ø¯ÙˆØ®Øª (Seam Thickness)</td></tr>
    <tr><td>Ù‚Ù„Ø§Ø¨ Ø¯Ø±Ø¨ (Cover Hook)</td></tr>
    <tr><td>Ù‚Ù„Ø§Ø¨ Ø¨Ø¯Ù†Ù‡ (Body Hook)</td></tr>
    <tr><td>Ø¶Ø®Ø§Ù…Øª ÙˆØ±Ù‚ Ø³Ø± (End Thickness)</td></tr>
    <tr><td>Ø¶Ø®Ø§Ù…Øª ÙˆØ±Ù‚ Ø¨Ø¯Ù†Ù‡ (Body Thickness)</td></tr>
    <tr><td>Ø§Ø®ØªÙ„Ø§Ù Ù‚Ù„Ø§Ø¨ (Hook Difference)</td></tr>
    <tr><td>ÙØ¶Ø§ÛŒ Ø¢Ø²Ø§Ø¯ (Free Space)</td></tr>
    <tr><td>Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ (Overlap %)</td></tr>
    <tr><td>Ú†Ø±ÙˆÚ©ÛŒØ¯Ú¯ÛŒ Ù‚Ù„Ø§Ø¨ Ø¯Ø±Ø¨</td></tr>
    <tr><td>ØªÛŒØ²Ú©Ø±Ø¯Ú¯ÛŒ Ø¯ÙˆØ®Øª</td></tr>
  </tbody>
</table>

<div id="warnings">
  <strong>âš ï¸ Ù…ÙˆØ§Ø±Ø¯ Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ Ø§ØµÙ„Ø§Ø­:</strong>
  <ul id="warningList"></ul>
</div>

<div class="footer-buttons">
  <button onclick="printReport()">ğŸ–¨ï¸ Ù¾Ø±ÛŒÙ†Øª</button>
  <button onclick="saveAsHTML()">ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ HTML</button>
  <button onclick="showHelp()">â„¹ï¸ Ø±Ø§Ù‡Ù†Ù…Ø§</button>
</div>

<script>
  let templateCount = 1;

  function toMM(val) { return val * 0.0254; }
  function formatDualUnit(val) { return `${val.toFixed(2)} (${toMM(val).toFixed(2)} mm)`; }

  // â¤ Ø¨Ø§ Enter Ø±ÙØªÙ† Ø¨Ù‡ ÙÛŒÙ„Ø¯ Ø¨Ø¹Ø¯ÛŒ
  document.querySelectorAll(".input-row input").forEach((input, index, all) => {
    input.addEventListener("keydown", e => {
      if (e.key === "Enter") {
        e.preventDefault();
        if (index < all.length - 1) all[index + 1].focus();
        else document.querySelector(".input-row button").focus();
      }
    });
  });

  function addTemplate() {
    const ids = ['length','seamThickness','coverHook','bodyHook','headThickness','bodyThickness'];
    const raw = ids.map(id => parseFloat(document.getElementById(id).value));

    if (raw.some(v => isNaN(v) || v < 0)) {
      alert('Ù„Ø·ÙØ§Ù‹ Ù‡Ù…Ù‡ ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ø¨Ø§ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø¹Ø¯Ø¯ÛŒ Ù…Ø«Ø¨Øª Ù¾Ø± Ú©Ù†ÛŒØ¯.');
      return;
    }

    const [length, seamThickness, coverHook, bodyHook, headThickness, bodyThickness] = raw;
    const hookDiff = Math.abs(coverHook - bodyHook);
    const freeSpace = Math.abs(seamThickness - (3 * headThickness + 2 * bodyThickness));
    const denom = length - (2.2 * headThickness + 1.1 * bodyThickness);
    let overlap = 0;
    if (denom !== 0) overlap = Math.abs((length - (coverHook + bodyHook + 1.1 * headThickness)) / denom * 100);

    if (templateCount > 1) {
      const th = document.createElement('th');
      th.textContent = `Ù‚Ø§Ù„Ø¨ ${templateCount}`;
      document.getElementById('headerRow').appendChild(th);
    }

    const values = [
      formatDualUnit(length), formatDualUnit(seamThickness),
      formatDualUnit(coverHook), formatDualUnit(bodyHook),
      formatDualUnit(headThickness), formatDualUnit(bodyThickness),
      formatDualUnit(hookDiff), formatDualUnit(freeSpace),
      overlap.toFixed(2), '-','-'
    ];

    const rows = document.querySelectorAll('#tableBody tr');
    rows.forEach((r,i) => {
      const td = document.createElement('td');
      td.textContent = values[i];
      td.style.color = '';
      r.appendChild(td);
    });

    const col = templateCount;
    const warnings = [];

    if (coverHook < 70) { rows[2].children[col].style.color = 'red'; warnings.push('Ù‚Ù„Ø§Ø¨ Ø¯Ø±Ø¨ Ú©Ù…ØªØ± Ø§Ø² 70'); }
    if (bodyHook < 70) { rows[3].children[col].style.color = 'red'; warnings.push('Ù‚Ù„Ø§Ø¨ Ø¨Ø¯Ù†Ù‡ Ú©Ù…ØªØ± Ø§Ø² 70'); }
    if (hookDiff > 7.8) { rows[6].children[col].style.color = 'red'; warnings.push('Ø§Ø®ØªÙ„Ø§Ù Ù‚Ù„Ø§Ø¨ Ø¨ÛŒØ´ØªØ± Ø§Ø² 7.8'); }
    if (freeSpace > 7.5) { rows[7].children[col].style.color = 'red'; warnings.push('ÙØ¶Ø§ÛŒ Ø¢Ø²Ø§Ø¯ Ø¨ÛŒØ´ØªØ± Ø§Ø² 7.5'); }

    // âœ… Ù‡Ø´Ø¯Ø§Ø± Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ
    if (overlap < 45) { rows[8].children[col].style.color = 'red'; warnings.push('Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ú©Ù…ØªØ± Ø§Ø² 45Ùª Ø§Ø³Øª'); }
    if (overlap > 90) { rows[8].children[col].style.color = 'red'; warnings.push('Ø¯Ø±ØµØ¯ Ø¯Ø±Ú¯ÛŒØ±ÛŒ Ø¨ÛŒØ´ØªØ± Ø§Ø² 90Ùª Ø§Ø³Øª'); }

    if (warnings.length) {
      const li = document.createElement('li');
      li.textContent = `Ù‚Ø§Ù„Ø¨ ${col}: ${warnings.join('ØŒ ')}`;
      document.getElementById('warningList').appendChild(li);
    }

    // Ø¨Ø¹Ø¯ Ø§Ø² Ù…Ø­Ø§Ø³Ø¨Ù‡ØŒ Ø¶Ø®Ø§Ù…Øª ÙˆØ±Ù‚â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ù†Ø´ÙˆØ¯
    document.getElementById('length').value = '';
    document.getElementById('seamThickness').value = '';
    document.getElementById('coverHook').value = '';
    document.getElementById('bodyHook').value = '';
    document.getElementById('length').focus();

    templateCount++;
  }

  function getReportHTML(name) {
  return `
    <html lang="fa" dir="rtl"><head><meta charset="UTF-8">
    <title>Ú¯Ø²Ø§Ø±Ø´ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¢Ù†Ø§Ù„ÛŒØ²</title>
    <style>
      body{font-family:Tahoma;direction:rtl;padding:20px;}
      table{border-collapse:collapse;width:100%;margin-top:10px;}
      th,td{border:1px solid #000;padding:6px;text-align:center;}
      h3{text-align:center;}
      .footer{margin-top:20px;text-align:center;font-size:12px;color:#444;}
    </style>
    </head><body>
      <h3>Ú¯Ø²Ø§Ø±Ø´ Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ø¢Ù†Ø§Ù„ÛŒØ²</h3>
      <p><strong>ØªØ§Ø±ÛŒØ®:</strong> ${new Date().toLocaleDateString("fa-IR")}</p>
      ${document.getElementById("resultsTable").outerHTML}
      ${document.getElementById("warnings").outerHTML}
      <div><strong>Ú¯Ø²Ø§Ø±Ø´Ú¯Ø±:</strong> ${name}</div>
      <div class="footer">
        Â© 2025 - ØªÙ‡ÛŒÙ‡â€ŒÚ©Ù†Ù†Ø¯Ù‡: Ù…ØµÛŒØ¨ Ø®Ø§Ù†ÛŒ | Ú©Ù†ØªØ±Ù„ Ú©ÛŒÙÛŒØª Ú©Ø§Ø±Ø®Ø§Ù†Ù‡ ÛŒÚ© ÙˆÛŒÚ© Ø¯Ø´Øª Ù…Ø±ØºØ§Ø¨
      </div>
    </body></html>`;
}

  function printReport() {
    let name = prompt("Ù†Ø§Ù… Ú¯Ø²Ø§Ø±Ø´Ú¯Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:", "Ù…Ù‡Ù†Ø¯Ø³ Ø®Ø§Ù†ÛŒ") || "Ù…Ù‡Ù†Ø¯Ø³ Ø®Ø§Ù†ÛŒ";
    const w = window.open(""); w.document.write(getReportHTML(name)); w.document.close(); w.print();
  }

  function saveAsHTML() {
    let name = prompt("Ù†Ø§Ù… Ú¯Ø²Ø§Ø±Ø´Ú¯Ø± Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:", "Ù…Ù‡Ù†Ø¯Ø³ Ø®Ø§Ù†ÛŒ") || "Ù…Ù‡Ù†Ø¯Ø³ Ø®Ø§Ù†ÛŒ";
    const blob = new Blob([getReportHTML(name)], { type: "text/html" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a"); a.href = url; a.download = `Ú¯Ø²Ø§Ø±Ø´_${new Date().toLocaleDateString("fa-IR")}.html`; a.click();
    URL.revokeObjectURL(url);
  }

  function showHelp() {
  const overlay = document.createElement("div");
  overlay.className = "help-overlay";
  const box = document.createElement("div");
  box.className = "help-box";
  box.innerHTML = `
    <h3>ğŸ“˜ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡</h3>
    <ul>
      <li>1ï¸âƒ£ Ù…Ù‚Ø§Ø¯ÛŒØ± Ø±Ø§ Ø¨Ø± Ø­Ø³Ø¨ <b>0.001 Ø§ÛŒÙ†Ú†</b> ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</li>
      <li>2ï¸âƒ£ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ <b>Ù…Ø­Ø§Ø³Ø¨Ù‡/Ø¬Ø¯ÛŒØ¯</b> Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.</li>
      <li>3ï¸âƒ£ Ù†ØªØ§ÛŒØ¬ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ Ùˆ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ú†Ø§Ù¾ ÛŒØ§ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†ÛŒØ¯.</li>
      <li>4ï¸âƒ£ Ø¨Ø±Ø§ÛŒ Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø§Ø·Ù„Ø§Ø¹Ø§ØªØŒ Ú©Ù„ÛŒØ¯ <b>F5</b> Ø±Ø§ ÙØ´Ø§Ø± Ø¯Ù‡ÛŒØ¯.</li>
      <li>5ï¸âƒ£ Ø§Ú¯Ø± Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ Ø¨Ø±Ø§ÛŒ Ø¨Ù‡Ø¨ÙˆØ¯ Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø¯Ø§Ø±ÛŒØ¯ØŒ Ù„Ø·ÙØ§Ù‹ Ù†Ø¸Ø±ØªØ§Ù† Ø±Ø§ Ø¨Ø§ Ù…Ø§ Ø¯Ø± Ù…ÛŒØ§Ù† Ø¨Ú¯Ø°Ø§Ø±ÛŒØ¯ âœ…</li>
    </ul>
    <p style="font-size:13px; text-align:center; margin-top:5px;">
      âœï¸ ØªÙ‡ÛŒÙ‡â€ŒÚ©Ù†Ù†Ø¯Ù‡: <b>Ù…ØµÛŒØ¨ Ø®Ø§Ù†ÛŒ</b><br>
      ğŸ“ 09173206052<br>
      ğŸ› ï¸ Ù†Ø³Ø®Ù‡ 1.01
    </p>
    <button onclick="document.body.removeChild(this.parentNode.parentNode)">Ø¨Ø³ØªÙ†</button>`;
  overlay.appendChild(box);
  document.body.appendChild(overlay);
}

</script>

</body>
</html>
